===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
extruder: pressure_advance: 0.031000
pressure_advance_smooth_time: 0.040000
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
toolhead: max_velocity: 300.000000
max_accel: 200.000000
minimum_cruise_ratio: 0.500000
square_corner_velocity: 4.000000
Args: ['/home/klipper/klipper/klippy/klippy.py', '/home/klipper/printer_data/config/printer.cfg', '-I', '/home/klipper/printer_data/comms/klippy.serial', '-l', '/home/klipper/printer_data/logs/klippy.log', '-a', '/home/klipper/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94-dirty'
Untracked files: klippy/extras/gcode_shell_command.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]'
webhooks client 281472998420784: {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
=============== Log rollover at Sun Dec 29 17:59:39 2024 ===============
Running Command {update_git_script}...:
[1;93m[0m Checking for installed dependencies /[K[1;92m[0m Checking for installed dependencies [1;92mDone![0m


Klipper-Backup is up to date


From https://github.com/Ferz82/github-klipper-backup
 * branch            main       -> FETCH_HEAD

Already up to date.

skipping non-regular file "printer_data/comms/klippy.serial"
skipping non-regular file "printer_data/comms/klippy.sock"
skipping non-regular file "printer_data/comms/moonraker.sock"

skipping non-regular file "printer_data/config/KAMP"
skipping non-regular file "printer_data/config/mainsail.cfg"

skipping non-regular file "printer_data/logs/mainsail-access.log"
skipping non-regular file "printer_data/logs/mainsail-error.log"

Skipping symbolic link: mainsail-config/mainsail.cfg

Command {update_git_script} timed out
Stats 327832.0: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000019 bytes_write=47764678 bytes_read=82794345 bytes_retransmit=0 bytes_invalid=0 send_seq=2243076 receive_seq=2243076 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998304  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.96 cputime=9085.385 memavail=1690372 print_time=293199.091 buffer_time=0.116 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
webhooks client 281472998420784: Disconnected
Restarting printer
Start printer at Sun Dec 29 18:02:21 2024 (1735484541.9 327833.3)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473001803776: New connection
webhooks client 281473001803776: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 26, 'next_clock': 906460160, 'value': 31196, '#name': 'analog_in_state', '#sent_time': 327836.491949949, '#receive_time': 327836.537038324}
mcu 'mcu': got {'oid': 14, 'next_clock': 919420160, 'value': 31101, '#name': 'analog_in_state', '#sent_time': 327836.699480532, '#receive_time': 327836.71702715696}
mcu 'mcu': got {'oid': 18, 'next_clock': 922300160, 'value': 31197, '#name': 'analog_in_state', '#sent_time': 327836.75124274, '#receive_time': 327836.757031157}
mcu 'mcu': got {'oid': 26, 'next_clock': 928060160, 'value': 31199, '#name': 'analog_in_state', '#sent_time': 327836.803102574, '#receive_time': 327836.837037407}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Write g-code response
Traceback (most recent call last):
  File "/home/klipper/klipper/klippy/gcode.py", line 459, in _respond_raw
    os.write(self.fd, (msg+"\n").encode())
BlockingIOError: [Errno 11] Resource temporarily unavailable
Stats 327837.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3022 bytes_read=6247 bytes_retransmit=0 bytes_invalid=0 send_seq=213 receive_seq=210 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=1883 upcoming_bytes=298 freq=71996152  orange_pi: temp=51.1 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=3.88 cputime=9088.467 memavail=1690828 print_time=293204.564 buffer_time=0.241 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473001803776
webhooks: registering remote method 'reboot_machine' for connection id: 281473001803776
webhooks: registering remote method 'pause_job_queue' for connection id: 281473001803776
webhooks: registering remote method 'start_job_queue' for connection id: 281473001803776
Stats 327838.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5437 bytes_read=6558 bytes_retransmit=0 bytes_invalid=0 send_seq=259 receive_seq=259 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997863  orange_pi: temp=49.1 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.73 cputime=9088.511 memavail=1689892 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327839.4: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000115 mcu_task_stddev=0.000266 bytes_write=5495 bytes_read=6746 bytes_retransmit=0 bytes_invalid=0 send_seq=264 receive_seq=264 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998051  orange_pi: temp=48.7 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.73 cputime=9088.551 memavail=1689032 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327840.4: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000115 mcu_task_stddev=0.000266 bytes_write=5520 bytes_read=6937 bytes_retransmit=0 bytes_invalid=0 send_seq=267 receive_seq=267 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998099  orange_pi: temp=48.1 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.73 cputime=9088.573 memavail=1688636 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327841.4: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000115 mcu_task_stddev=0.000266 bytes_write=5526 bytes_read=7103 bytes_retransmit=0 bytes_invalid=0 send_seq=268 receive_seq=268 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998058  orange_pi: temp=48.5 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.73 cputime=9088.594 memavail=1688032 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327842.4: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000115 mcu_task_stddev=0.000266 bytes_write=5532 bytes_read=7254 bytes_retransmit=0 bytes_invalid=0 send_seq=269 receive_seq=269 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998128  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.73 cputime=9088.615 memavail=1687888 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327843.4: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000115 mcu_task_stddev=0.000266 bytes_write=5552 bytes_read=7440 bytes_retransmit=0 bytes_invalid=0 send_seq=271 receive_seq=271 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998175  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.67 cputime=9088.637 memavail=1688728 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327844.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000020 bytes_write=5572 bytes_read=7626 bytes_retransmit=0 bytes_invalid=0 send_seq=273 receive_seq=273 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998154  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.67 cputime=9088.658 memavail=1688996 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327845.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000020 bytes_write=5578 bytes_read=7777 bytes_retransmit=0 bytes_invalid=0 send_seq=274 receive_seq=274 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998168  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.67 cputime=9088.679 memavail=1688268 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327846.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000020 bytes_write=5584 bytes_read=7958 bytes_retransmit=0 bytes_invalid=0 send_seq=275 receive_seq=275 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998165  orange_pi: temp=48.1 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.67 cputime=9088.700 memavail=1688036 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327847.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000020 bytes_write=5590 bytes_read=8124 bytes_retransmit=0 bytes_invalid=0 send_seq=276 receive_seq=276 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998170  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.67 cputime=9088.721 memavail=1688556 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327848.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000020 bytes_write=5596 bytes_read=8275 bytes_retransmit=0 bytes_invalid=0 send_seq=277 receive_seq=277 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998193  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.46 cputime=9088.742 memavail=1688080 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327849.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5602 bytes_read=8470 bytes_retransmit=0 bytes_invalid=0 send_seq=278 receive_seq=278 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998198  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.46 cputime=9088.763 memavail=1687848 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327850.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5608 bytes_read=8636 bytes_retransmit=0 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998209  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.46 cputime=9088.782 memavail=1687600 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 327851.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5614 bytes_read=8787 bytes_retransmit=0 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998226  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.46 cputime=9088.803 memavail=1687848 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327852.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5620 bytes_read=8968 bytes_retransmit=0 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998235  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.46 cputime=9088.827 memavail=1687600 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327853.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5626 bytes_read=9134 bytes_retransmit=0 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998242  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.26 cputime=9088.848 memavail=1687376 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327854.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5632 bytes_read=9299 bytes_retransmit=0 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998242  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=3.26 cputime=9088.870 memavail=1687376 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327855.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5676 bytes_read=9500 bytes_retransmit=0 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998243  orange_pi: temp=47.6 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=3.26 cputime=9088.892 memavail=1686872 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327856.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5696 bytes_read=9671 bytes_retransmit=0 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998244  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.26 cputime=9088.914 memavail=1686872 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327857.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5716 bytes_read=9827 bytes_retransmit=0 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998246  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.26 cputime=9088.936 memavail=1687400 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327858.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5736 bytes_read=10013 bytes_retransmit=0 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.08 cputime=9088.958 memavail=1687672 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327859.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000024 bytes_write=5756 bytes_read=10199 bytes_retransmit=0 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.08 cputime=9088.980 memavail=1687944 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327860.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000024 bytes_write=5776 bytes_read=10355 bytes_retransmit=0 bytes_invalid=0 send_seq=298 receive_seq=298 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998254  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=3.08 cputime=9089.003 memavail=1687460 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327861.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000024 bytes_write=5796 bytes_read=10541 bytes_retransmit=0 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.08 cputime=9089.025 memavail=1687460 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327862.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000024 bytes_write=5802 bytes_read=10707 bytes_retransmit=0 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998255  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=3.08 cputime=9089.046 memavail=1688216 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327863.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000024 bytes_write=5808 bytes_read=10858 bytes_retransmit=0 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998262  orange_pi: temp=47.4 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.91 cputime=9089.068 memavail=1688732 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327864.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=5814 bytes_read=11054 bytes_retransmit=0 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998264  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.91 cputime=9089.090 memavail=1688764 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 327865.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=5820 bytes_read=11220 bytes_retransmit=0 bytes_invalid=0 send_seq=304 receive_seq=304 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=47.6 chamber_heater: target=0 temp=28.3 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.91 cputime=9089.112 memavail=1688764 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327866.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=5826 bytes_read=11371 bytes_retransmit=0 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998273  orange_pi: temp=47.7 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.91 cputime=9089.133 memavail=1689540 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327867.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=5846 bytes_read=11557 bytes_retransmit=0 bytes_invalid=0 send_seq=307 receive_seq=307 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998266  orange_pi: temp=47.5 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.91 cputime=9089.156 memavail=1689036 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327868.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=5852 bytes_read=11723 bytes_retransmit=0 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998269  orange_pi: temp=47.9 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.76 cputime=9089.178 memavail=1690064 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327869.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5878 bytes_read=11910 bytes_retransmit=0 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=48.0 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.76 cputime=9089.200 memavail=1690568 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327870.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5898 bytes_read=12096 bytes_retransmit=0 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998269  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.76 cputime=9089.221 memavail=1690064 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327871.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5904 bytes_read=12262 bytes_retransmit=0 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998269  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.2 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.76 cputime=9089.243 memavail=1690336 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327872.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5910 bytes_read=12413 bytes_retransmit=0 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.76 cputime=9089.265 memavail=1690336 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327873.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5930 bytes_read=12599 bytes_retransmit=0 bytes_invalid=0 send_seq=317 receive_seq=317 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=49.9 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.62 cputime=9089.287 memavail=1689604 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327874.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000018 bytes_write=5969 bytes_read=12780 bytes_retransmit=0 bytes_invalid=0 send_seq=321 receive_seq=321 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.62 cputime=9089.309 memavail=1689876 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327875.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000022 mcu_task_stddev=0.000023 bytes_write=6003 bytes_read=12956 bytes_retransmit=0 bytes_invalid=0 send_seq=324 receive_seq=324 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998276  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.62 cputime=9089.331 memavail=1689136 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327876.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000022 mcu_task_stddev=0.000023 bytes_write=6023 bytes_read=13142 bytes_retransmit=0 bytes_invalid=0 send_seq=326 receive_seq=326 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998279  orange_pi: temp=47.6 chamber_heater: target=0 temp=28.2 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.62 cputime=9089.353 memavail=1688636 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327877.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000022 mcu_task_stddev=0.000023 bytes_write=6029 bytes_read=13308 bytes_retransmit=0 bytes_invalid=0 send_seq=327 receive_seq=327 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998280  orange_pi: temp=47.4 chamber_heater: target=0 temp=28.2 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=2.62 cputime=9089.375 memavail=1688892 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327878.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000022 mcu_task_stddev=0.000023 bytes_write=6049 bytes_read=13479 bytes_retransmit=0 bytes_invalid=0 send_seq=329 receive_seq=329 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998283  orange_pi: temp=47.4 chamber_heater: target=0 temp=28.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.49 cputime=9089.397 memavail=1688908 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327879.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000022 mcu_task_stddev=0.000023 bytes_write=6069 bytes_read=13650 bytes_retransmit=0 bytes_invalid=0 send_seq=331 receive_seq=331 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998285  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.49 cputime=9089.419 memavail=1688404 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327880.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6089 bytes_read=13836 bytes_retransmit=0 bytes_invalid=0 send_seq=333 receive_seq=333 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998286  orange_pi: temp=47.6 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.49 cputime=9089.441 memavail=1688152 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327881.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6123 bytes_read=14012 bytes_retransmit=0 bytes_invalid=0 send_seq=336 receive_seq=336 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998286  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.4 pwm=0.000 sysload=2.49 cputime=9089.463 memavail=1688152 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327882.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6129 bytes_read=14178 bytes_retransmit=0 bytes_invalid=0 send_seq=337 receive_seq=337 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998287  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.49 cputime=9089.485 memavail=1687412 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327883.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6154 bytes_read=14346 bytes_retransmit=0 bytes_invalid=0 send_seq=340 receive_seq=340 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998286  orange_pi: temp=47.8 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.37 cputime=9089.510 memavail=1687412 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327884.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6160 bytes_read=14501 bytes_retransmit=0 bytes_invalid=0 send_seq=341 receive_seq=341 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998285  orange_pi: temp=47.6 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.37 cputime=9089.531 memavail=1686920 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327885.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6166 bytes_read=14671 bytes_retransmit=0 bytes_invalid=0 send_seq=342 receive_seq=342 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998284  orange_pi: temp=47.4 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.37 cputime=9089.553 memavail=1686424 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327886.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6172 bytes_read=14826 bytes_retransmit=0 bytes_invalid=0 send_seq=343 receive_seq=343 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998286  orange_pi: temp=47.4 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.37 cputime=9089.575 memavail=1686180 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Running Command {update_git_script}...:
[1;93m[0m Checking for installed dependencies /[K[1;92m[0m Checking for installed dependencies [1;92mDone![0m


Stats 327887.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6178 bytes_read=14992 bytes_retransmit=0 bytes_invalid=0 send_seq=344 receive_seq=344 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=48.2 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.37 cputime=9089.608 memavail=1689740 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Klipper-Backup is up to date


Stats 327888.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6184 bytes_read=15158 bytes_retransmit=0 bytes_invalid=0 send_seq=345 receive_seq=345 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=49.6 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.26 cputime=9089.637 memavail=1683480 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327889.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000021 mcu_task_stddev=0.000022 bytes_write=6209 bytes_read=15334 bytes_retransmit=0 bytes_invalid=0 send_seq=348 receive_seq=348 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=49.1 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.26 cputime=9089.665 memavail=1685268 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
From https://github.com/Ferz82/github-klipper-backup
 * branch            main       -> FETCH_HEAD

Already up to date.

Stats 327890.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000014 bytes_write=6215 bytes_read=15514 bytes_retransmit=0 bytes_invalid=0 send_seq=349 receive_seq=349 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=49.8 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.26 cputime=9089.700 memavail=1688252 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
skipping non-regular file "printer_data/comms/klippy.serial"
skipping non-regular file "printer_data/comms/klippy.sock"
skipping non-regular file "printer_data/comms/moonraker.sock"

skipping non-regular file "printer_data/config/KAMP"
skipping non-regular file "printer_data/config/mainsail.cfg"

Stats 327891.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000014 bytes_write=6221 bytes_read=15680 bytes_retransmit=0 bytes_invalid=0 send_seq=350 receive_seq=350 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=50.7 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.26 cputime=9089.738 memavail=1680896 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
skipping non-regular file "printer_data/logs/mainsail-access.log"
skipping non-regular file "printer_data/logs/mainsail-error.log"

Stats 327892.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000014 bytes_write=6241 bytes_read=15851 bytes_retransmit=0 bytes_invalid=0 send_seq=352 receive_seq=352 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=49.9 chamber_heater: target=0 temp=28.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.26 cputime=9089.774 memavail=1687724 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327893.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000014 bytes_write=6247 bytes_read=16017 bytes_retransmit=0 bytes_invalid=0 send_seq=353 receive_seq=353 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998308  orange_pi: temp=49.5 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.24 cputime=9089.806 memavail=1681976 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327894.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000014 bytes_write=6253 bytes_read=16183 bytes_retransmit=0 bytes_invalid=0 send_seq=354 receive_seq=354 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998309  orange_pi: temp=49.4 chamber_heater: target=0 temp=28.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.24 cputime=9089.839 memavail=1685324 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 327895.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000016 bytes_write=6259 bytes_read=16363 bytes_retransmit=0 bytes_invalid=0 send_seq=355 receive_seq=355 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998309  orange_pi: temp=49.2 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.24 cputime=9089.870 memavail=1691464 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 327896.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000016 bytes_write=6265 bytes_read=16529 bytes_retransmit=0 bytes_invalid=0 send_seq=356 receive_seq=356 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998306  orange_pi: temp=48.5 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=2.24 cputime=9089.895 memavail=1690832 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.2 pwm=0.000
Stats 327897.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000016 bytes_write=6271 bytes_read=16695 bytes_retransmit=0 bytes_invalid=0 send_seq=357 receive_seq=357 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998306  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.24 cputime=9089.925 memavail=1690360 print_time=293204.564 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Skipping symbolic link: mainsail-config/mainsail.cfg

Command {update_git_script} timed out
Starting Klippy...
Args: ['/home/klipper/klipper/klippy/klippy.py', '/home/klipper/printer_data/config/printer.cfg', '-I', '/home/klipper/printer_data/comms/klippy.serial', '-l', '/home/klipper/printer_data/logs/klippy.log', '-a', '/home/klipper/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94-dirty'
Untracked files: klippy/extras/gcode_shell_command.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]'
Start printer at Sun Dec 29 18:07:55 2024 (1735484875.9 328167.3)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281472870401984: New connection
webhooks client 281472870401984: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 26, 'next_clock': 3494023680, 'value': 31197, '#name': 'analog_in_state', '#sent_time': 328170.736212233, '#receive_time': 328170.745568358}
mcu 'mcu': got {'oid': 14, 'next_clock': 3506983680, 'value': 31156, '#name': 'analog_in_state', '#sent_time': 328170.906089983, '#receive_time': 328170.92491256597}
mcu 'mcu': got {'oid': 18, 'next_clock': 3509863680, 'value': 31180, '#name': 'analog_in_state', '#sent_time': 328170.957990858, '#receive_time': 328170.96491177497}
mcu 'mcu': got {'oid': 26, 'next_clock': 3515623680, 'value': 31186, '#name': 'analog_in_state', '#sent_time': 328171.01002415, '#receive_time': 328171.04496110795}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 328171.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3075 bytes_read=6237 bytes_retransmit=9 bytes_invalid=0 send_seq=220 receive_seq=217 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2125 upcoming_bytes=8 freq=71997477  orange_pi: temp=50.7 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.36 cputime=3.946 memavail=1696628 print_time=293538.819 buffer_time=0.241 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281472870401984
webhooks: registering remote method 'reboot_machine' for connection id: 281472870401984
webhooks: registering remote method 'pause_job_queue' for connection id: 281472870401984
webhooks: registering remote method 'start_job_queue' for connection id: 281472870401984
Stats 328172.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5437 bytes_read=6588 bytes_retransmit=9 bytes_invalid=0 send_seq=265 receive_seq=265 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998271  orange_pi: temp=49.5 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.36 cputime=4.012 memavail=1694676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328173.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5476 bytes_read=6766 bytes_retransmit=9 bytes_invalid=0 send_seq=268 receive_seq=268 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000029  orange_pi: temp=49.1 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.33 cputime=4.052 memavail=1694428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328174.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5482 bytes_read=6932 bytes_retransmit=9 bytes_invalid=0 send_seq=269 receive_seq=269 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998858  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.33 cputime=4.074 memavail=1693924 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328175.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5488 bytes_read=7113 bytes_retransmit=9 bytes_invalid=0 send_seq=270 receive_seq=270 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998500  orange_pi: temp=48.2 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.33 cputime=4.096 memavail=1693672 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328176.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5494 bytes_read=7264 bytes_retransmit=9 bytes_invalid=0 send_seq=271 receive_seq=271 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998415  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.33 cputime=4.117 memavail=1693420 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.6 pwm=0.000
Stats 328177.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5500 bytes_read=7430 bytes_retransmit=9 bytes_invalid=0 send_seq=272 receive_seq=272 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998375  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.33 cputime=4.139 memavail=1693420 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328178.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5506 bytes_read=7625 bytes_retransmit=9 bytes_invalid=0 send_seq=273 receive_seq=273 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998327  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.38 cputime=4.161 memavail=1692920 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328179.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5512 bytes_read=7776 bytes_retransmit=9 bytes_invalid=0 send_seq=274 receive_seq=274 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998325  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.38 cputime=4.183 memavail=1692668 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328180.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5518 bytes_read=7942 bytes_retransmit=9 bytes_invalid=0 send_seq=275 receive_seq=275 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998295  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.38 cputime=4.204 memavail=1692416 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328181.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5524 bytes_read=8115 bytes_retransmit=9 bytes_invalid=0 send_seq=276 receive_seq=276 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.38 cputime=4.226 memavail=1692164 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328182.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5530 bytes_read=8255 bytes_retransmit=9 bytes_invalid=0 send_seq=277 receive_seq=277 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.38 cputime=4.248 memavail=1691912 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328183.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5536 bytes_read=8424 bytes_retransmit=9 bytes_invalid=0 send_seq=278 receive_seq=278 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.35 cputime=4.268 memavail=1691912 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328184.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5542 bytes_read=8593 bytes_retransmit=9 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.35 cputime=4.290 memavail=1691912 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328185.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5548 bytes_read=8743 bytes_retransmit=9 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998280  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.35 cputime=4.311 memavail=1691912 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328186.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5554 bytes_read=8909 bytes_retransmit=9 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998285  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.35 cputime=4.333 memavail=1691912 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328187.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5560 bytes_read=9090 bytes_retransmit=9 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998284  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.8 pwm=0.000 sysload=1.35 cputime=4.355 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328188.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5566 bytes_read=9255 bytes_retransmit=9 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998277  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.32 cputime=4.378 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328189.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5572 bytes_read=9436 bytes_retransmit=9 bytes_invalid=0 send_seq=284 receive_seq=284 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998274  orange_pi: temp=48.9 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.8 pwm=0.000 sysload=1.32 cputime=4.400 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328190.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5578 bytes_read=9602 bytes_retransmit=9 bytes_invalid=0 send_seq=285 receive_seq=285 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.32 cputime=4.422 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328191.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5584 bytes_read=9753 bytes_retransmit=9 bytes_invalid=0 send_seq=286 receive_seq=286 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.32 cputime=4.444 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328192.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5590 bytes_read=9934 bytes_retransmit=9 bytes_invalid=0 send_seq=287 receive_seq=287 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998284  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.32 cputime=4.467 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328193.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5596 bytes_read=10114 bytes_retransmit=9 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.30 cputime=4.491 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328194.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5602 bytes_read=10265 bytes_retransmit=9 bytes_invalid=0 send_seq=289 receive_seq=289 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998294  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.30 cputime=4.513 memavail=1691676 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328195.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5608 bytes_read=10446 bytes_retransmit=9 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998295  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.30 cputime=4.535 memavail=1691428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328196.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5614 bytes_read=10612 bytes_retransmit=9 bytes_invalid=0 send_seq=291 receive_seq=291 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998298  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.30 cputime=4.557 memavail=1691428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328197.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5620 bytes_read=10763 bytes_retransmit=9 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.30 cputime=4.580 memavail=1691428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328198.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5626 bytes_read=10958 bytes_retransmit=9 bytes_invalid=0 send_seq=293 receive_seq=293 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998301  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.27 cputime=4.601 memavail=1691428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328199.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5632 bytes_read=11124 bytes_retransmit=9 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998304  orange_pi: temp=47.0 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.27 cputime=4.623 memavail=1691428 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328200.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5638 bytes_read=11275 bytes_retransmit=9 bytes_invalid=0 send_seq=295 receive_seq=295 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998307  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.27 cputime=4.645 memavail=1691688 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328201.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5644 bytes_read=11456 bytes_retransmit=9 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998310  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.27 cputime=4.668 memavail=1691968 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328202.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5650 bytes_read=11622 bytes_retransmit=9 bytes_invalid=0 send_seq=297 receive_seq=297 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998311  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.27 cputime=4.690 memavail=1691988 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328203.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5662 bytes_read=11803 bytes_retransmit=9 bytes_invalid=0 send_seq=299 receive_seq=299 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998308  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.25 cputime=4.713 memavail=1691484 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328204.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5668 bytes_read=11984 bytes_retransmit=9 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998305  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.25 cputime=4.735 memavail=1690976 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328205.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5674 bytes_read=12150 bytes_retransmit=9 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.25 cputime=4.757 memavail=1690724 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328206.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5680 bytes_read=12301 bytes_retransmit=9 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=47.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.25 cputime=4.779 memavail=1690724 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328207.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5686 bytes_read=12482 bytes_retransmit=9 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.25 cputime=4.802 memavail=1690724 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 328208.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5692 bytes_read=12662 bytes_retransmit=9 bytes_invalid=0 send_seq=304 receive_seq=304 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998299  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.23 cputime=4.824 memavail=1690472 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328209.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5698 bytes_read=12813 bytes_retransmit=9 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998298  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.23 cputime=4.845 memavail=1690224 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328210.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5704 bytes_read=12994 bytes_retransmit=9 bytes_invalid=0 send_seq=306 receive_seq=306 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=46.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.23 cputime=4.868 memavail=1690224 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328211.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5710 bytes_read=13160 bytes_retransmit=9 bytes_invalid=0 send_seq=307 receive_seq=307 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998299  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.23 cputime=4.889 memavail=1690224 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328212.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5716 bytes_read=13311 bytes_retransmit=9 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.23 cputime=4.911 memavail=1689972 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328213.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5722 bytes_read=13506 bytes_retransmit=9 bytes_invalid=0 send_seq=309 receive_seq=309 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998301  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.21 cputime=4.933 memavail=1689296 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328214.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5728 bytes_read=13672 bytes_retransmit=9 bytes_invalid=0 send_seq=310 receive_seq=310 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=47.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.21 cputime=4.955 memavail=1689212 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328215.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5734 bytes_read=13823 bytes_retransmit=9 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998300  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.21 cputime=4.977 memavail=1689212 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328216.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5740 bytes_read=14004 bytes_retransmit=9 bytes_invalid=0 send_seq=312 receive_seq=312 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998299  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.21 cputime=4.999 memavail=1689216 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328217.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5746 bytes_read=14170 bytes_retransmit=9 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998298  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.21 cputime=5.021 memavail=1689224 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 328218.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5752 bytes_read=14335 bytes_retransmit=9 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998297  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.20 cputime=5.043 memavail=1689484 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 328219.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5758 bytes_read=14516 bytes_retransmit=9 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.20 cputime=5.065 memavail=1689988 print_time=293538.819 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Starting Klippy...
Args: ['/home/klipper/klipper/klippy/klippy.py', '/home/klipper/printer_data/config/printer.cfg', '-I', '/home/klipper/printer_data/comms/klippy.serial', '-l', '/home/klipper/printer_data/logs/klippy.log', '-a', '/home/klipper/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94-dirty'
Untracked files: klippy/extras/gcode_shell_command.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]'
Start printer at Sun Dec 29 18:09:05 2024 (1735484945.5 21.4)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473146840176: New connection
mcu 'mcu': got {'oid': 14, 'next_clock': 993849088, 'value': 31096, '#name': 'analog_in_state', '#sent_time': 25.868105470000003, '#receive_time': 25.894913345000003}
webhooks client 281473146840176: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 18, 'next_clock': 996729088, 'value': 31178, '#name': 'analog_in_state', '#sent_time': 25.920920136000003, '#receive_time': 25.934996095000002}
mcu 'mcu': got {'oid': 26, 'next_clock': 1002489088, 'value': 31194, '#name': 'analog_in_state', '#sent_time': 25.97331072, '#receive_time': 26.014996261}
mcu 'mcu': got {'oid': 14, 'next_clock': 1015449088, 'value': 31102, '#name': 'analog_in_state', '#sent_time': 26.182624845000003, '#receive_time': 26.194972678000003}
mcu 'mcu': got {'oid': 18, 'next_clock': 1018329088, 'value': 31185, '#name': 'analog_in_state', '#sent_time': 26.182624845000003, '#receive_time': 26.235530595}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 26.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3068 bytes_read=6252 bytes_retransmit=9 bytes_invalid=0 send_seq=218 receive_seq=215 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2055 upcoming_bytes=70 freq=71999094  orange_pi: temp=56.2 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.16 cputime=4.881 memavail=1726944 print_time=293623.358 buffer_time=0.240 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473146840176
webhooks: registering remote method 'reboot_machine' for connection id: 281473146840176
webhooks: registering remote method 'pause_job_queue' for connection id: 281473146840176
webhooks: registering remote method 'start_job_queue' for connection id: 281473146840176
Stats 27.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5414 bytes_read=6498 bytes_retransmit=9 bytes_invalid=0 send_seq=262 receive_seq=262 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998447  orange_pi: temp=53.8 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.16 cputime=4.916 memavail=1726724 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
Stats 28.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5461 bytes_read=6704 bytes_retransmit=9 bytes_invalid=0 send_seq=266 receive_seq=266 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998255  orange_pi: temp=51.9 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.16 cputime=4.938 memavail=1724708 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 29.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5467 bytes_read=6870 bytes_retransmit=9 bytes_invalid=0 send_seq=267 receive_seq=267 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=51.7 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.16 cputime=4.956 memavail=1724708 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 30.8: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000114 mcu_task_stddev=0.000265 bytes_write=5473 bytes_read=7038 bytes_retransmit=9 bytes_invalid=0 send_seq=268 receive_seq=268 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998350  orange_pi: temp=51.5 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=2.14 cputime=4.973 memavail=1739088 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 31.8: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000114 mcu_task_stddev=0.000265 bytes_write=5479 bytes_read=7219 bytes_retransmit=9 bytes_invalid=0 send_seq=269 receive_seq=269 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998212  orange_pi: temp=49.3 chamber_heater: target=0 temp=28.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.14 cputime=4.986 memavail=1739212 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 32.8: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000114 mcu_task_stddev=0.000265 bytes_write=5485 bytes_read=7385 bytes_retransmit=9 bytes_invalid=0 send_seq=270 receive_seq=270 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998149  orange_pi: temp=48.4 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=2.14 cputime=5.000 memavail=1739212 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 33.8: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000114 mcu_task_stddev=0.000265 bytes_write=5491 bytes_read=7536 bytes_retransmit=9 bytes_invalid=0 send_seq=271 receive_seq=271 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998157  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=2.14 cputime=5.013 memavail=1739212 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 34.8: gcodein=0  mcu: mcu_awake=0.056 mcu_task_avg=0.000114 mcu_task_stddev=0.000265 bytes_write=5497 bytes_read=7717 bytes_retransmit=9 bytes_invalid=0 send_seq=272 receive_seq=272 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998158  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.14 cputime=5.027 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.6 pwm=0.000
Stats 35.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5503 bytes_read=7897 bytes_retransmit=9 bytes_invalid=0 send_seq=273 receive_seq=273 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998153  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=2.05 cputime=5.040 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 36.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5509 bytes_read=8048 bytes_retransmit=9 bytes_invalid=0 send_seq=274 receive_seq=274 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998157  orange_pi: temp=47.7 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=2.05 cputime=5.053 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 37.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5515 bytes_read=8229 bytes_retransmit=9 bytes_invalid=0 send_seq=275 receive_seq=275 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998178  orange_pi: temp=47.9 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.05 cputime=5.067 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 38.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5521 bytes_read=8395 bytes_retransmit=9 bytes_invalid=0 send_seq=276 receive_seq=276 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998193  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.9 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=2.05 cputime=5.080 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 39.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5527 bytes_read=8546 bytes_retransmit=9 bytes_invalid=0 send_seq=277 receive_seq=277 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998199  orange_pi: temp=47.8 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.8 pwm=0.000 sysload=2.05 cputime=5.093 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 40.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5533 bytes_read=8741 bytes_retransmit=9 bytes_invalid=0 send_seq=278 receive_seq=278 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998216  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.97 cputime=5.106 memavail=1739536 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 41.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5539 bytes_read=8907 bytes_retransmit=9 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998228  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.97 cputime=5.119 memavail=1739540 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 42.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5545 bytes_read=9058 bytes_retransmit=9 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998238  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.8 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.97 cputime=5.132 memavail=1739540 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 43.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5551 bytes_read=9239 bytes_retransmit=9 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998243  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.97 cputime=5.146 memavail=1739540 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 44.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5557 bytes_read=9405 bytes_retransmit=9 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998254  orange_pi: temp=48.0 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.97 cputime=5.160 memavail=1739540 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 45.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5563 bytes_read=9570 bytes_retransmit=9 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.89 cputime=5.172 memavail=1739548 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 46.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5569 bytes_read=9751 bytes_retransmit=9 bytes_invalid=0 send_seq=284 receive_seq=284 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.8 pwm=0.000 sysload=1.89 cputime=5.185 memavail=1739548 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 47.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5575 bytes_read=9917 bytes_retransmit=9 bytes_invalid=0 send_seq=285 receive_seq=285 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.89 cputime=5.198 memavail=1739548 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 48.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5581 bytes_read=10068 bytes_retransmit=9 bytes_invalid=0 send_seq=286 receive_seq=286 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.89 cputime=5.211 memavail=1739548 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 49.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5587 bytes_read=10249 bytes_retransmit=9 bytes_invalid=0 send_seq=287 receive_seq=287 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.89 cputime=5.224 memavail=1739324 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 50.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5593 bytes_read=10429 bytes_retransmit=9 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998256  orange_pi: temp=47.1 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.82 cputime=5.237 memavail=1739324 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 51.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5599 bytes_read=10580 bytes_retransmit=9 bytes_invalid=0 send_seq=289 receive_seq=289 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998261  orange_pi: temp=47.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.82 cputime=5.249 memavail=1739324 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 52.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5605 bytes_read=10761 bytes_retransmit=9 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998260  orange_pi: temp=47.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.82 cputime=5.262 memavail=1739324 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 53.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5611 bytes_read=10927 bytes_retransmit=9 bytes_invalid=0 send_seq=291 receive_seq=291 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998261  orange_pi: temp=47.0 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.82 cputime=5.275 memavail=1739324 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 54.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5617 bytes_read=11078 bytes_retransmit=9 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998265  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.82 cputime=5.288 memavail=1739072 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 55.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5629 bytes_read=11289 bytes_retransmit=9 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998272  orange_pi: temp=47.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.75 cputime=5.301 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 56.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5635 bytes_read=11455 bytes_retransmit=9 bytes_invalid=0 send_seq=295 receive_seq=295 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.75 cputime=5.314 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 57.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5641 bytes_read=11606 bytes_retransmit=9 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998278  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.75 cputime=5.327 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 58.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5647 bytes_read=11787 bytes_retransmit=9 bytes_invalid=0 send_seq=297 receive_seq=297 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998279  orange_pi: temp=46.7 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.75 cputime=5.340 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.2 pwm=0.000
Stats 59.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5653 bytes_read=11953 bytes_retransmit=9 bytes_invalid=0 send_seq=298 receive_seq=298 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998281  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.75 cputime=5.353 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 60.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5659 bytes_read=12118 bytes_retransmit=9 bytes_invalid=0 send_seq=299 receive_seq=299 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998284  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.69 cputime=5.366 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 61.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5665 bytes_read=12299 bytes_retransmit=9 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998286  orange_pi: temp=46.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.69 cputime=5.379 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 62.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5671 bytes_read=12465 bytes_retransmit=9 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998288  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.69 cputime=5.392 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 63.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5677 bytes_read=12616 bytes_retransmit=9 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998288  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.69 cputime=5.405 memavail=1739076 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 64.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5683 bytes_read=12797 bytes_retransmit=9 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=47.0 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.69 cputime=5.418 memavail=1738344 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 65.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5689 bytes_read=12977 bytes_retransmit=9 bytes_invalid=0 send_seq=304 receive_seq=304 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=47.0 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.64 cputime=5.432 memavail=1738344 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 66.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5695 bytes_read=13128 bytes_retransmit=9 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998291  orange_pi: temp=47.0 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.64 cputime=5.445 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 67.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5701 bytes_read=13309 bytes_retransmit=9 bytes_invalid=0 send_seq=306 receive_seq=306 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=46.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.64 cputime=5.458 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 68.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5707 bytes_read=13475 bytes_retransmit=9 bytes_invalid=0 send_seq=307 receive_seq=307 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998291  orange_pi: temp=46.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.64 cputime=5.471 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 69.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5713 bytes_read=13626 bytes_retransmit=9 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.64 cputime=5.484 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 70.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5719 bytes_read=13821 bytes_retransmit=9 bytes_invalid=0 send_seq=309 receive_seq=309 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=46.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.58 cputime=5.497 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 71.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5725 bytes_read=13976 bytes_retransmit=9 bytes_invalid=0 send_seq=310 receive_seq=310 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=46.5 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.58 cputime=5.509 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 72.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5731 bytes_read=14117 bytes_retransmit=9 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=47.2 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.58 cputime=5.522 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 73.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5737 bytes_read=14286 bytes_retransmit=9 bytes_invalid=0 send_seq=312 receive_seq=312 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=46.8 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.58 cputime=5.536 memavail=1738352 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 74.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5743 bytes_read=14444 bytes_retransmit=9 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998290  orange_pi: temp=46.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.58 cputime=5.549 memavail=1738100 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 75.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5749 bytes_read=14609 bytes_retransmit=9 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=47.4 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.8 pwm=0.000 sysload=1.54 cputime=5.562 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 76.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5755 bytes_read=14790 bytes_retransmit=9 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998291  orange_pi: temp=46.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.54 cputime=5.575 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 77.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5761 bytes_read=14956 bytes_retransmit=9 bytes_invalid=0 send_seq=316 receive_seq=316 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=46.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.5 pwm=0.000 sysload=1.54 cputime=5.589 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 78.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5800 bytes_read=15122 bytes_retransmit=9 bytes_invalid=0 send_seq=320 receive_seq=320 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998292  orange_pi: temp=46.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.54 cputime=5.602 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.6 pwm=0.000
Stats 79.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5806 bytes_read=15303 bytes_retransmit=9 bytes_invalid=0 send_seq=321 receive_seq=321 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998293  orange_pi: temp=47.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.54 cputime=5.615 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 80.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5812 bytes_read=15469 bytes_retransmit=9 bytes_invalid=0 send_seq=322 receive_seq=322 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998294  orange_pi: temp=46.8 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.49 cputime=5.628 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 81.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000017 bytes_write=5818 bytes_read=15634 bytes_retransmit=9 bytes_invalid=0 send_seq=323 receive_seq=323 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=46.8 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.49 cputime=5.641 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 82.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000017 bytes_write=5824 bytes_read=15815 bytes_retransmit=9 bytes_invalid=0 send_seq=324 receive_seq=324 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998297  orange_pi: temp=46.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.49 cputime=5.654 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.5 pwm=0.000
Stats 83.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000017 bytes_write=5830 bytes_read=15981 bytes_retransmit=9 bytes_invalid=0 send_seq=325 receive_seq=325 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=46.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.7 pwm=0.000 sysload=1.49 cputime=5.667 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 84.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000017 bytes_write=5836 bytes_read=16132 bytes_retransmit=9 bytes_invalid=0 send_seq=326 receive_seq=326 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=46.6 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.49 cputime=5.680 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 85.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000017 bytes_write=5842 bytes_read=16313 bytes_retransmit=9 bytes_invalid=0 send_seq=327 receive_seq=327 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998296  orange_pi: temp=46.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.45 cputime=5.694 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Stats 86.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5848 bytes_read=16493 bytes_retransmit=9 bytes_invalid=0 send_seq=328 receive_seq=328 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998297  orange_pi: temp=46.9 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.6 pwm=0.000 sysload=1.45 cputime=5.707 memavail=1738112 print_time=293623.358 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.4 pwm=0.000
Running Command {update_git_script}...:
[1;93m[0m Checking for installed dependencies /[K[1;92m[0m Checking for installed dependencies [1;92mDone![0m


Klipper-Backup is up to date


From https://github.com/Ferz82/github-klipper-backup
 * branch            main       -> FETCH_HEAD

Already up to date.

skipping non-regular file "printer_data/comms/klippy.serial"
skipping non-regular file "printer_data/comms/klippy.sock"
skipping non-regular file "printer_data/comms/moonraker.sock"

skipping non-regular file "printer_data/config/KAMP"
skipping non-regular file "printer_data/config/mainsail.cfg"

skipping non-regular file "printer_data/logs/mainsail-access.log"
skipping non-regular file "printer_data/logs/mainsail-error.log"

Skipping symbolic link: mainsail-config/mainsail.cfg

Command {update_git_script} timed out
Starting Klippy...
Args: ['/home/klipper/klipper/klippy/klippy.py', '/home/klipper/printer_data/config/printer.cfg', '-I', '/home/klipper/printer_data/comms/klippy.serial', '-l', '/home/klipper/printer_data/logs/klippy.log', '-a', '/home/klipper/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94-dirty'
Untracked files: klippy/extras/gcode_shell_command.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]'
Start printer at Sun Dec 29 20:17:16 2024 (1735492636.0 21.2)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473611424736: New connection
webhooks client 281473611424736: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 27.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3252 bytes_read=6168 bytes_retransmit=0 bytes_invalid=0 send_seq=230 receive_seq=227 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2125 upcoming_bytes=0 freq=71999328  orange_pi: temp=50.6 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.13 cputime=4.979 memavail=1735544 print_time=32.187 buffer_time=0.241 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473611424736
webhooks: registering remote method 'reboot_machine' for connection id: 281473611424736
webhooks: registering remote method 'pause_job_queue' for connection id: 281473611424736
webhooks: registering remote method 'start_job_queue' for connection id: 281473611424736
Stats 28.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5639 bytes_read=6574 bytes_retransmit=0 bytes_invalid=0 send_seq=277 receive_seq=277 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998493  orange_pi: temp=48.4 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=2.13 cputime=5.022 memavail=1733284 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 29.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5645 bytes_read=6725 bytes_retransmit=0 bytes_invalid=0 send_seq=278 receive_seq=278 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998400  orange_pi: temp=46.5 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.13 cputime=5.038 memavail=1733284 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 30.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5651 bytes_read=6906 bytes_retransmit=0 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998479  orange_pi: temp=48.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.44 cputime=5.060 memavail=1737152 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 31.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000116 mcu_task_stddev=0.000266 bytes_write=5657 bytes_read=7089 bytes_retransmit=0 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998387  orange_pi: temp=50.5 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.44 cputime=5.081 memavail=1736292 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 32.2: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000116 mcu_task_stddev=0.000266 bytes_write=5663 bytes_read=7255 bytes_retransmit=0 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998294  orange_pi: temp=43.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.44 cputime=5.094 memavail=1736392 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 33.2: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000116 mcu_task_stddev=0.000266 bytes_write=5669 bytes_read=7421 bytes_retransmit=0 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998201  orange_pi: temp=43.0 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=2.44 cputime=5.108 memavail=1736156 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 34.2: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000116 mcu_task_stddev=0.000266 bytes_write=5675 bytes_read=7587 bytes_retransmit=0 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998206  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=2.44 cputime=5.122 memavail=1735656 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 35.2: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000116 mcu_task_stddev=0.000266 bytes_write=5681 bytes_read=7753 bytes_retransmit=0 bytes_invalid=0 send_seq=284 receive_seq=284 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998231  orange_pi: temp=42.2 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.32 cputime=5.136 memavail=1735656 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.0 pwm=0.000
Stats 36.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5687 bytes_read=7933 bytes_retransmit=0 bytes_invalid=0 send_seq=285 receive_seq=285 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998203  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.32 cputime=5.149 memavail=1735656 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 37.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5693 bytes_read=8099 bytes_retransmit=0 bytes_invalid=0 send_seq=286 receive_seq=286 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998198  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=2.32 cputime=5.163 memavail=1735656 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 38.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5699 bytes_read=8265 bytes_retransmit=0 bytes_invalid=0 send_seq=287 receive_seq=287 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998207  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=2.32 cputime=5.177 memavail=1735404 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 39.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5705 bytes_read=8431 bytes_retransmit=0 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998216  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.32 cputime=5.190 memavail=1734912 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 40.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5711 bytes_read=8597 bytes_retransmit=0 bytes_invalid=0 send_seq=289 receive_seq=289 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998211  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.22 cputime=5.204 memavail=1734912 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 41.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5717 bytes_read=8777 bytes_retransmit=0 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998216  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.22 cputime=5.217 memavail=1734916 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 42.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5723 bytes_read=8943 bytes_retransmit=0 bytes_invalid=0 send_seq=291 receive_seq=291 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998222  orange_pi: temp=41.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=2.22 cputime=5.231 memavail=1734664 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 43.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5729 bytes_read=9109 bytes_retransmit=0 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998219  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.22 cputime=5.245 memavail=1734412 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 44.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5735 bytes_read=9275 bytes_retransmit=0 bytes_invalid=0 send_seq=293 receive_seq=293 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998225  orange_pi: temp=41.2 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=2.22 cputime=5.259 memavail=1733908 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 45.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5741 bytes_read=9441 bytes_retransmit=0 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998230  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.12 cputime=5.273 memavail=1733432 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 46.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5747 bytes_read=9621 bytes_retransmit=0 bytes_invalid=0 send_seq=295 receive_seq=295 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998226  orange_pi: temp=41.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.12 cputime=5.288 memavail=1733204 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 47.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5753 bytes_read=9787 bytes_retransmit=0 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998229  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=2.12 cputime=5.302 memavail=1733208 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 48.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5759 bytes_read=9953 bytes_retransmit=0 bytes_invalid=0 send_seq=297 receive_seq=297 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998224  orange_pi: temp=41.1 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.12 cputime=5.315 memavail=1732956 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 49.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5765 bytes_read=10119 bytes_retransmit=0 bytes_invalid=0 send_seq=298 receive_seq=298 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998228  orange_pi: temp=41.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=2.12 cputime=5.328 memavail=1732964 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 50.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5771 bytes_read=10285 bytes_retransmit=0 bytes_invalid=0 send_seq=299 receive_seq=299 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998232  orange_pi: temp=41.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.03 cputime=5.342 memavail=1732972 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 51.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5777 bytes_read=10465 bytes_retransmit=0 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998231  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.03 cputime=5.355 memavail=1733524 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 52.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5783 bytes_read=10631 bytes_retransmit=0 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998237  orange_pi: temp=41.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.03 cputime=5.369 memavail=1733272 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 53.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5789 bytes_read=10797 bytes_retransmit=0 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998241  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.03 cputime=5.382 memavail=1733524 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 54.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5795 bytes_read=10958 bytes_retransmit=0 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998245  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=2.03 cputime=5.395 memavail=1733800 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 55.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5807 bytes_read=11128 bytes_retransmit=0 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998247  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.95 cputime=5.408 memavail=1733296 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 56.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5813 bytes_read=11297 bytes_retransmit=0 bytes_invalid=0 send_seq=306 receive_seq=306 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998247  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.95 cputime=5.422 memavail=1732044 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 57.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5819 bytes_read=11452 bytes_retransmit=0 bytes_invalid=0 send_seq=307 receive_seq=307 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998248  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.95 cputime=5.435 memavail=1733056 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 58.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5825 bytes_read=11616 bytes_retransmit=0 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998245  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.95 cputime=5.448 memavail=1733060 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 59.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5831 bytes_read=11782 bytes_retransmit=0 bytes_invalid=0 send_seq=309 receive_seq=309 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998244  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.95 cputime=5.462 memavail=1733328 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 60.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5837 bytes_read=11948 bytes_retransmit=0 bytes_invalid=0 send_seq=310 receive_seq=310 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998243  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.87 cputime=5.475 memavail=1733856 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 61.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5843 bytes_read=12128 bytes_retransmit=0 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998244  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.87 cputime=5.489 memavail=1734128 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 62.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5849 bytes_read=12294 bytes_retransmit=0 bytes_invalid=0 send_seq=312 receive_seq=312 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998247  orange_pi: temp=41.6 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.87 cputime=5.503 memavail=1733876 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 63.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5855 bytes_read=12460 bytes_retransmit=0 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.87 cputime=5.516 memavail=1733876 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 64.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5861 bytes_read=12626 bytes_retransmit=0 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.9 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.87 cputime=5.529 memavail=1733896 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 65.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5867 bytes_read=12792 bytes_retransmit=0 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=41.1 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.80 cputime=5.542 memavail=1733896 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 66.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5873 bytes_read=12972 bytes_retransmit=0 bytes_invalid=0 send_seq=316 receive_seq=316 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=41.4 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.80 cputime=5.556 memavail=1733900 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 67.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5879 bytes_read=13138 bytes_retransmit=0 bytes_invalid=0 send_seq=317 receive_seq=317 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=41.5 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.80 cputime=5.569 memavail=1734152 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 68.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5885 bytes_read=13304 bytes_retransmit=0 bytes_invalid=0 send_seq=318 receive_seq=318 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.5 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.80 cputime=5.582 memavail=1733900 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 69.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5891 bytes_read=13470 bytes_retransmit=0 bytes_invalid=0 send_seq=319 receive_seq=319 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.80 cputime=5.596 memavail=1733448 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 70.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5897 bytes_read=13636 bytes_retransmit=0 bytes_invalid=0 send_seq=320 receive_seq=320 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998253  orange_pi: temp=41.9 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.74 cputime=5.609 memavail=1733700 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 71.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5903 bytes_read=13816 bytes_retransmit=0 bytes_invalid=0 send_seq=321 receive_seq=321 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.3 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.74 cputime=5.622 memavail=1733948 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 72.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5909 bytes_read=13982 bytes_retransmit=0 bytes_invalid=0 send_seq=322 receive_seq=322 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.4 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.74 cputime=5.635 memavail=1733948 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 73.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5915 bytes_read=14148 bytes_retransmit=0 bytes_invalid=0 send_seq=323 receive_seq=323 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.3 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.74 cputime=5.650 memavail=1733976 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 74.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5921 bytes_read=14314 bytes_retransmit=0 bytes_invalid=0 send_seq=324 receive_seq=324 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.3 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.74 cputime=5.663 memavail=1734480 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 75.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5927 bytes_read=14480 bytes_retransmit=0 bytes_invalid=0 send_seq=325 receive_seq=325 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.5 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.68 cputime=5.675 memavail=1734480 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 76.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5933 bytes_read=14660 bytes_retransmit=0 bytes_invalid=0 send_seq=326 receive_seq=326 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.7 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.68 cputime=5.691 memavail=1733764 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 77.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5939 bytes_read=14826 bytes_retransmit=0 bytes_invalid=0 send_seq=327 receive_seq=327 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998254  orange_pi: temp=42.3 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.68 cputime=5.704 memavail=1733520 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 78.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5945 bytes_read=14992 bytes_retransmit=0 bytes_invalid=0 send_seq=328 receive_seq=328 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998253  orange_pi: temp=41.7 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=26.1 pwm=0.000 sysload=1.68 cputime=5.717 memavail=1733016 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 79.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5951 bytes_read=15158 bytes_retransmit=0 bytes_invalid=0 send_seq=329 receive_seq=329 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998253  orange_pi: temp=41.6 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.68 cputime=5.730 memavail=1732512 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 80.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5957 bytes_read=15324 bytes_retransmit=0 bytes_invalid=0 send_seq=330 receive_seq=330 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998256  orange_pi: temp=41.1 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.62 cputime=5.744 memavail=1731764 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 81.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5963 bytes_read=15504 bytes_retransmit=0 bytes_invalid=0 send_seq=331 receive_seq=331 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=41.4 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.62 cputime=5.757 memavail=1731260 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 82.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5969 bytes_read=15670 bytes_retransmit=0 bytes_invalid=0 send_seq=332 receive_seq=332 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.9 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.62 cputime=5.770 memavail=1730756 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 83.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5975 bytes_read=15836 bytes_retransmit=0 bytes_invalid=0 send_seq=333 receive_seq=333 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.9 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.62 cputime=5.783 memavail=1730756 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 84.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5981 bytes_read=16002 bytes_retransmit=0 bytes_invalid=0 send_seq=334 receive_seq=334 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=42.1 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.6 pwm=0.000 sysload=1.62 cputime=5.796 memavail=1731536 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 85.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5987 bytes_read=16168 bytes_retransmit=0 bytes_invalid=0 send_seq=335 receive_seq=335 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.8 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.57 cputime=5.809 memavail=1731556 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 86.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5993 bytes_read=16348 bytes_retransmit=0 bytes_invalid=0 send_seq=336 receive_seq=336 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.3 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.57 cputime=5.822 memavail=1731316 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 87.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5999 bytes_read=16514 bytes_retransmit=0 bytes_invalid=0 send_seq=337 receive_seq=337 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.7 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.57 cputime=5.835 memavail=1731092 print_time=32.187 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Starting Klippy...
Args: ['/home/klipper/klipper/klippy/klippy.py', '/home/klipper/printer_data/config/printer.cfg', '-I', '/home/klipper/printer_data/comms/klippy.serial', '-l', '/home/klipper/printer_data/logs/klippy.log', '-a', '/home/klipper/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94-dirty'
Untracked files: klippy/extras/gcode_shell_command.py, klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]'
Start printer at Sun Dec 29 21:36:56 2024 (1735497416.1 191.4)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473462748832: New connection
webhooks client 281473462748832: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 14, 'next_clock': 1546778112, 'value': 31149, '#name': 'analog_in_state', '#sent_time': 195.34936134199998, '#receive_time': 195.35221892500002}
mcu 'mcu': got {'oid': 18, 'next_clock': 1549658112, 'value': 31231, '#name': 'analog_in_state', '#sent_time': 195.34936134199998, '#receive_time': 195.392271717}
mcu 'mcu': got {'oid': 26, 'next_clock': 1555418112, 'value': 31239, '#name': 'analog_in_state', '#sent_time': 195.45302934199998, '#receive_time': 195.472225592}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 196.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3070 bytes_read=6223 bytes_retransmit=9 bytes_invalid=0 send_seq=218 receive_seq=215 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2125 upcoming_bytes=8 freq=71994865  orange_pi: temp=45.3 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.27 cputime=4.334 memavail=1735004 print_time=201.128 buffer_time=0.241 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473462748832
webhooks: registering remote method 'reboot_machine' for connection id: 281473462748832
webhooks: registering remote method 'pause_job_queue' for connection id: 281473462748832
webhooks: registering remote method 'start_job_queue' for connection id: 281473462748832
Stats 197.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5460 bytes_read=6624 bytes_retransmit=9 bytes_invalid=0 send_seq=264 receive_seq=264 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997825  orange_pi: temp=43.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.27 cputime=4.368 memavail=1734248 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 198.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5466 bytes_read=6792 bytes_retransmit=9 bytes_invalid=0 send_seq=265 receive_seq=265 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998126  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.27 cputime=4.382 memavail=1733996 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 199.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5472 bytes_read=6973 bytes_retransmit=9 bytes_invalid=0 send_seq=266 receive_seq=266 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998052  orange_pi: temp=42.2 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=4.393 memavail=1734268 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 200.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5478 bytes_read=7139 bytes_retransmit=9 bytes_invalid=0 send_seq=267 receive_seq=267 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998026  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.27 cputime=4.406 memavail=1734788 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 201.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5484 bytes_read=7290 bytes_retransmit=9 bytes_invalid=0 send_seq=268 receive_seq=268 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998080  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=4.420 memavail=1735320 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 202.1: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000113 mcu_task_stddev=0.000264 bytes_write=5490 bytes_read=7471 bytes_retransmit=9 bytes_invalid=0 send_seq=269 receive_seq=269 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998087  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=4.434 memavail=1734816 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 203.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5496 bytes_read=7651 bytes_retransmit=9 bytes_invalid=0 send_seq=270 receive_seq=270 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998103  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=4.447 memavail=1733808 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 204.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5502 bytes_read=7802 bytes_retransmit=9 bytes_invalid=0 send_seq=271 receive_seq=271 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998142  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.460 memavail=1733332 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 205.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5508 bytes_read=7983 bytes_retransmit=9 bytes_invalid=0 send_seq=272 receive_seq=272 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998152  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.473 memavail=1733068 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 206.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5514 bytes_read=8149 bytes_retransmit=9 bytes_invalid=0 send_seq=273 receive_seq=273 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998159  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=4.486 memavail=1732828 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 207.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5520 bytes_read=8300 bytes_retransmit=9 bytes_invalid=0 send_seq=274 receive_seq=274 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998170  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.23 cputime=4.499 memavail=1732828 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 208.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5526 bytes_read=8495 bytes_retransmit=9 bytes_invalid=0 send_seq=275 receive_seq=275 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998181  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=4.515 memavail=1732324 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 209.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5532 bytes_read=8661 bytes_retransmit=9 bytes_invalid=0 send_seq=276 receive_seq=276 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998187  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=4.528 memavail=1731824 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 210.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5538 bytes_read=8812 bytes_retransmit=9 bytes_invalid=0 send_seq=277 receive_seq=277 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998195  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=4.541 memavail=1732076 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 211.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5544 bytes_read=8993 bytes_retransmit=9 bytes_invalid=0 send_seq=278 receive_seq=278 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998212  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.29 cputime=4.554 memavail=1732096 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 212.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5550 bytes_read=9159 bytes_retransmit=9 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998214  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.29 cputime=4.567 memavail=1732116 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 213.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5556 bytes_read=9324 bytes_retransmit=9 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998224  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.29 cputime=4.580 memavail=1732136 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 214.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5562 bytes_read=9505 bytes_retransmit=9 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998224  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.29 cputime=4.594 memavail=1732408 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 215.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5568 bytes_read=9671 bytes_retransmit=9 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998233  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.29 cputime=4.607 memavail=1731924 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 216.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5574 bytes_read=9822 bytes_retransmit=9 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998234  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=4.620 memavail=1732196 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 217.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5580 bytes_read=10003 bytes_retransmit=9 bytes_invalid=0 send_seq=284 receive_seq=284 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998239  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=4.633 memavail=1732220 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 218.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5586 bytes_read=10183 bytes_retransmit=9 bytes_invalid=0 send_seq=285 receive_seq=285 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998240  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.27 cputime=4.645 memavail=1731484 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 219.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5592 bytes_read=10334 bytes_retransmit=9 bytes_invalid=0 send_seq=286 receive_seq=286 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998238  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=4.658 memavail=1731232 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 220.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5598 bytes_read=10515 bytes_retransmit=9 bytes_invalid=0 send_seq=287 receive_seq=287 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998236  orange_pi: temp=41.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=4.671 memavail=1731240 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 221.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5604 bytes_read=10681 bytes_retransmit=9 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998237  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.684 memavail=1730756 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 222.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5610 bytes_read=10832 bytes_retransmit=9 bytes_invalid=0 send_seq=289 receive_seq=289 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998241  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.697 memavail=1730756 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 223.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5616 bytes_read=11027 bytes_retransmit=9 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998241  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.710 memavail=1731532 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 224.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5622 bytes_read=11193 bytes_retransmit=9 bytes_invalid=0 send_seq=291 receive_seq=291 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998240  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.724 memavail=1731852 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 225.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5628 bytes_read=11344 bytes_retransmit=9 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998246  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=4.737 memavail=1731100 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 226.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5634 bytes_read=11525 bytes_retransmit=9 bytes_invalid=0 send_seq=293 receive_seq=293 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=41.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=4.751 memavail=1730596 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 227.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5640 bytes_read=11691 bytes_retransmit=9 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=4.764 memavail=1730596 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 228.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5652 bytes_read=11872 bytes_retransmit=9 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.1 pwm=0.000 sysload=1.23 cputime=4.778 memavail=1730348 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 229.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5658 bytes_read=12053 bytes_retransmit=9 bytes_invalid=0 send_seq=297 receive_seq=297 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=42.3 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=4.791 memavail=1730352 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 230.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5664 bytes_read=12219 bytes_retransmit=9 bytes_invalid=0 send_seq=298 receive_seq=298 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.23 cputime=4.804 memavail=1730352 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 231.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5670 bytes_read=12370 bytes_retransmit=9 bytes_invalid=0 send_seq=299 receive_seq=299 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=4.817 memavail=1729876 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 232.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5676 bytes_read=12551 bytes_retransmit=9 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=4.831 memavail=1729900 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 233.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5682 bytes_read=12724 bytes_retransmit=9 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998250  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.21 cputime=4.844 memavail=1729900 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 234.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5688 bytes_read=12865 bytes_retransmit=9 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=4.857 memavail=1729944 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 235.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5694 bytes_read=13034 bytes_retransmit=9 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=4.870 memavail=1729944 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 236.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5700 bytes_read=13189 bytes_retransmit=9 bytes_invalid=0 send_seq=304 receive_seq=304 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.8 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.19 cputime=4.883 memavail=1729944 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 237.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5706 bytes_read=13338 bytes_retransmit=9 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998253  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=4.896 memavail=1729692 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 238.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5712 bytes_read=13533 bytes_retransmit=9 bytes_invalid=0 send_seq=306 receive_seq=306 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=4.911 memavail=1729692 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 239.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5718 bytes_read=13699 bytes_retransmit=9 bytes_invalid=0 send_seq=307 receive_seq=307 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.19 cputime=4.925 memavail=1729692 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 240.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5724 bytes_read=13850 bytes_retransmit=9 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.19 cputime=4.938 memavail=1729696 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 241.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5730 bytes_read=14031 bytes_retransmit=9 bytes_invalid=0 send_seq=309 receive_seq=309 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=42.0 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.17 cputime=4.952 memavail=1729464 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 242.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5736 bytes_read=14197 bytes_retransmit=9 bytes_invalid=0 send_seq=310 receive_seq=310 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=4.965 memavail=1729968 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 243.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5742 bytes_read=14362 bytes_retransmit=9 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=4.978 memavail=1729968 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 244.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5748 bytes_read=14543 bytes_retransmit=9 bytes_invalid=0 send_seq=312 receive_seq=312 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998251  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=4.992 memavail=1730016 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 245.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5754 bytes_read=14709 bytes_retransmit=9 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998254  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=26.1 pwm=0.000 sysload=1.17 cputime=5.006 memavail=1730792 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 246.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5760 bytes_read=14860 bytes_retransmit=9 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998255  orange_pi: temp=41.5 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.16 cputime=5.018 memavail=1730300 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 247.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5766 bytes_read=15041 bytes_retransmit=9 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.4 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.16 cputime=5.032 memavail=1730056 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 248.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5772 bytes_read=15221 bytes_retransmit=9 bytes_invalid=0 send_seq=316 receive_seq=316 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.16 cputime=5.046 memavail=1730816 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 249.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5778 bytes_read=15372 bytes_retransmit=9 bytes_invalid=0 send_seq=317 receive_seq=317 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.16 cputime=5.059 memavail=1730584 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 250.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5784 bytes_read=15553 bytes_retransmit=9 bytes_invalid=0 send_seq=318 receive_seq=318 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.16 cputime=5.072 memavail=1730332 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 251.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5790 bytes_read=15719 bytes_retransmit=9 bytes_invalid=0 send_seq=319 receive_seq=319 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=41.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.15 cputime=5.085 memavail=1730332 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 252.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5796 bytes_read=15870 bytes_retransmit=9 bytes_invalid=0 send_seq=320 receive_seq=320 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.15 cputime=5.099 memavail=1730604 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 253.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5802 bytes_read=16065 bytes_retransmit=9 bytes_invalid=0 send_seq=321 receive_seq=321 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=41.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.15 cputime=5.112 memavail=1730604 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 254.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5808 bytes_read=16231 bytes_retransmit=9 bytes_invalid=0 send_seq=322 receive_seq=322 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=41.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.15 cputime=5.125 memavail=1730652 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 255.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5814 bytes_read=16382 bytes_retransmit=9 bytes_invalid=0 send_seq=323 receive_seq=323 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.15 cputime=5.138 memavail=1730672 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 256.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000017 mcu_task_stddev=0.000012 bytes_write=5820 bytes_read=16563 bytes_retransmit=9 bytes_invalid=0 send_seq=324 receive_seq=324 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.14 cputime=5.152 memavail=1731432 print_time=201.128 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 467.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=7137 bytes_read=52112 bytes_retransmit=9 bytes_invalid=0 send_seq=540 receive_seq=540 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998278  orange_pi: temp=42.2 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=9.326 memavail=1732608 print_time=472.739 buffer_time=0.694 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
webhooks client 281473462748832: Disconnected
Restarting printer
Start printer at Sun Dec 29 21:41:33 2024 (1735497693.7 469.1)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[neopixel panel_ring]
pin = PA8
chain_count = 16

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473462568368: New connection
webhooks client 281473462568368: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 14, 'next_clock': 15941632, 'value': 31120, '#name': 'analog_in_state', '#sent_time': 472.314214849, '#receive_time': 472.358860516}
mcu 'mcu': got {'oid': 18, 'next_clock': 18821632, 'value': 31236, '#name': 'analog_in_state', '#sent_time': 472.36608280800004, '#receive_time': 472.398888058}
mcu 'mcu': got {'oid': 26, 'next_clock': 24581632, 'value': 31228, '#name': 'analog_in_state', '#sent_time': 472.470076391, '#receive_time': 472.478868224}
mcu 'mcu': got {'oid': 14, 'next_clock': 37541632, 'value': 31127, '#name': 'analog_in_state', '#sent_time': 472.62600284900003, '#receive_time': 472.658869433}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Attempting automated MCU 'mcu' restart: CRC mismatch
Attempting MCU 'mcu' reset command
webhooks client 281473462568368: Disconnected
Restarting printer
Start printer at Sun Dec 29 21:41:38 2024 (1735497698.4 473.8)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[neopixel panel_ring]
pin = PA8
chain_count = 16

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473465977920: New connection
webhooks client 281473465977920: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 477.9: gcodein=0  mcu: mcu_awake=0.009 mcu_task_avg=0.000030 mcu_task_stddev=0.000050 bytes_write=3266 bytes_read=6191 bytes_retransmit=9 bytes_invalid=0 send_seq=230 receive_seq=227 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=1780 upcoming_bytes=401 freq=71994740  orange_pi: temp=44.1 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.29 cputime=15.294 memavail=1731064 print_time=5.407 buffer_time=0.241 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473465977920
webhooks: registering remote method 'reboot_machine' for connection id: 281473465977920
webhooks: registering remote method 'pause_job_queue' for connection id: 281473465977920
webhooks: registering remote method 'start_job_queue' for connection id: 281473465977920
Stats 478.9: gcodein=0  mcu: mcu_awake=0.009 mcu_task_avg=0.000030 mcu_task_stddev=0.000050 bytes_write=5673 bytes_read=6457 bytes_retransmit=9 bytes_invalid=0 send_seq=275 receive_seq=275 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997393  orange_pi: temp=43.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.29 cputime=15.336 memavail=1731616 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
Stats 479.9: gcodein=0  mcu: mcu_awake=0.009 mcu_task_avg=0.000030 mcu_task_stddev=0.000050 bytes_write=5720 bytes_read=6648 bytes_retransmit=9 bytes_invalid=0 send_seq=279 receive_seq=279 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997937  orange_pi: temp=43.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.29 cputime=15.374 memavail=1731668 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 480.9: gcodein=0  mcu: mcu_awake=0.009 mcu_task_avg=0.000030 mcu_task_stddev=0.000050 bytes_write=5726 bytes_read=6814 bytes_retransmit=9 bytes_invalid=0 send_seq=280 receive_seq=280 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998112  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=15.396 memavail=1731428 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 481.9: gcodein=0  mcu: mcu_awake=0.009 mcu_task_avg=0.000030 mcu_task_stddev=0.000050 bytes_write=5732 bytes_read=6980 bytes_retransmit=9 bytes_invalid=0 send_seq=281 receive_seq=281 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998076  orange_pi: temp=43.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=15.417 memavail=1731176 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 482.9: gcodein=0  mcu: mcu_awake=0.050 mcu_task_avg=0.000186 mcu_task_stddev=0.000344 bytes_write=5738 bytes_read=7163 bytes_retransmit=9 bytes_invalid=0 send_seq=282 receive_seq=282 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998070  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.27 cputime=15.438 memavail=1730928 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 483.9: gcodein=0  mcu: mcu_awake=0.050 mcu_task_avg=0.000186 mcu_task_stddev=0.000344 bytes_write=5744 bytes_read=7329 bytes_retransmit=9 bytes_invalid=0 send_seq=283 receive_seq=283 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998116  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.27 cputime=15.460 memavail=1731984 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 484.9: gcodein=0  mcu: mcu_awake=0.050 mcu_task_avg=0.000186 mcu_task_stddev=0.000344 bytes_write=5750 bytes_read=7495 bytes_retransmit=9 bytes_invalid=0 send_seq=284 receive_seq=284 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998165  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.27 cputime=15.481 memavail=1732508 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 485.9: gcodein=0  mcu: mcu_awake=0.050 mcu_task_avg=0.000186 mcu_task_stddev=0.000344 bytes_write=5756 bytes_read=7661 bytes_retransmit=9 bytes_invalid=0 send_seq=285 receive_seq=285 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998158  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=15.502 memavail=1732276 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 486.9: gcodein=0  mcu: mcu_awake=0.050 mcu_task_avg=0.000186 mcu_task_stddev=0.000344 bytes_write=5762 bytes_read=7827 bytes_retransmit=9 bytes_invalid=0 send_seq=286 receive_seq=286 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998163  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.25 cputime=15.523 memavail=1732296 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 487.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5768 bytes_read=8007 bytes_retransmit=9 bytes_invalid=0 send_seq=287 receive_seq=287 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998187  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=15.545 memavail=1731792 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 488.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5774 bytes_read=8173 bytes_retransmit=9 bytes_invalid=0 send_seq=288 receive_seq=288 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998195  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.25 cputime=15.565 memavail=1731288 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 489.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5780 bytes_read=8339 bytes_retransmit=9 bytes_invalid=0 send_seq=289 receive_seq=289 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998215  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.25 cputime=15.587 memavail=1731036 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 490.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5786 bytes_read=8505 bytes_retransmit=9 bytes_invalid=0 send_seq=290 receive_seq=290 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998232  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=15.608 memavail=1731292 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 491.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5792 bytes_read=8671 bytes_retransmit=9 bytes_invalid=0 send_seq=291 receive_seq=291 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998243  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=15.629 memavail=1730804 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 492.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5798 bytes_read=8837 bytes_retransmit=9 bytes_invalid=0 send_seq=292 receive_seq=292 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998237  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=15.650 memavail=1730556 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 493.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5804 bytes_read=9017 bytes_retransmit=9 bytes_invalid=0 send_seq=293 receive_seq=293 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998242  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=15.671 memavail=1730556 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 494.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5810 bytes_read=9183 bytes_retransmit=9 bytes_invalid=0 send_seq=294 receive_seq=294 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998244  orange_pi: temp=43.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=15.692 memavail=1730304 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 495.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5816 bytes_read=9349 bytes_retransmit=9 bytes_invalid=0 send_seq=295 receive_seq=295 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998241  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=15.713 memavail=1731080 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 496.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5822 bytes_read=9515 bytes_retransmit=9 bytes_invalid=0 send_seq=296 receive_seq=296 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998238  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.1 pwm=0.000 sysload=1.21 cputime=15.734 memavail=1731856 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 497.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5828 bytes_read=9696 bytes_retransmit=9 bytes_invalid=0 send_seq=297 receive_seq=297 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998237  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=15.755 memavail=1732128 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 498.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5834 bytes_read=9861 bytes_retransmit=9 bytes_invalid=0 send_seq=298 receive_seq=298 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998236  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=15.776 memavail=1732132 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 499.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5840 bytes_read=10027 bytes_retransmit=9 bytes_invalid=0 send_seq=299 receive_seq=299 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998234  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.21 cputime=15.797 memavail=1732656 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 500.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5846 bytes_read=10208 bytes_retransmit=9 bytes_invalid=0 send_seq=300 receive_seq=300 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998234  orange_pi: temp=42.1 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.19 cputime=15.818 memavail=1731648 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 501.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5852 bytes_read=10359 bytes_retransmit=9 bytes_invalid=0 send_seq=301 receive_seq=301 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998242  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=15.839 memavail=1731920 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 502.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5858 bytes_read=10525 bytes_retransmit=9 bytes_invalid=0 send_seq=302 receive_seq=302 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998243  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=15.861 memavail=1731260 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 503.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5864 bytes_read=10720 bytes_retransmit=9 bytes_invalid=0 send_seq=303 receive_seq=303 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998245  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=15.882 memavail=1730552 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 504.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5870 bytes_read=10871 bytes_retransmit=9 bytes_invalid=0 send_seq=304 receive_seq=304 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998247  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.19 cputime=15.904 memavail=1731068 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 505.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5876 bytes_read=11037 bytes_retransmit=9 bytes_invalid=0 send_seq=305 receive_seq=305 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998252  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.26 cputime=15.925 memavail=1731072 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 506.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5882 bytes_read=11218 bytes_retransmit=9 bytes_invalid=0 send_seq=306 receive_seq=306 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998253  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.26 cputime=15.947 memavail=1731848 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 507.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=5894 bytes_read=11385 bytes_retransmit=9 bytes_invalid=0 send_seq=308 receive_seq=308 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=42.8 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.26 cputime=15.968 memavail=1732120 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 508.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5900 bytes_read=11565 bytes_retransmit=9 bytes_invalid=0 send_seq=309 receive_seq=309 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.26 cputime=15.988 memavail=1731868 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 509.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5906 bytes_read=11746 bytes_retransmit=9 bytes_invalid=0 send_seq=310 receive_seq=310 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.26 cputime=16.010 memavail=1732644 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.0 pwm=0.000
Stats 510.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5912 bytes_read=11897 bytes_retransmit=9 bytes_invalid=0 send_seq=311 receive_seq=311 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.24 cputime=16.030 memavail=1732896 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 511.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5918 bytes_read=12063 bytes_retransmit=9 bytes_invalid=0 send_seq=312 receive_seq=312 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.24 cputime=16.050 memavail=1733420 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 512.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5924 bytes_read=12244 bytes_retransmit=9 bytes_invalid=0 send_seq=313 receive_seq=313 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998258  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.24 cputime=16.069 memavail=1734196 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 513.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5930 bytes_read=12409 bytes_retransmit=9 bytes_invalid=0 send_seq=314 receive_seq=314 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998257  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=26.1 pwm=0.000 sysload=1.24 cputime=16.089 memavail=1734516 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.0 pwm=0.000
Stats 514.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5936 bytes_read=12575 bytes_retransmit=9 bytes_invalid=0 send_seq=315 receive_seq=315 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=42.8 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.24 cputime=16.110 memavail=1734792 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 515.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5942 bytes_read=12756 bytes_retransmit=9 bytes_invalid=0 send_seq=316 receive_seq=316 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.22 cputime=16.131 memavail=1735044 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 516.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5948 bytes_read=12907 bytes_retransmit=9 bytes_invalid=0 send_seq=317 receive_seq=317 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998259  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.6 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.22 cputime=16.151 memavail=1735820 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 517.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5954 bytes_read=13073 bytes_retransmit=9 bytes_invalid=0 send_seq=318 receive_seq=318 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998260  orange_pi: temp=42.4 chamber_heater: target=0 temp=27.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.22 cputime=16.173 memavail=1736092 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 518.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5960 bytes_read=13268 bytes_retransmit=9 bytes_invalid=0 send_seq=319 receive_seq=319 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998263  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.22 cputime=16.194 memavail=1735860 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 519.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5966 bytes_read=13419 bytes_retransmit=9 bytes_invalid=0 send_seq=320 receive_seq=320 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998269  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.22 cputime=16.215 memavail=1735104 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 520.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5972 bytes_read=13585 bytes_retransmit=9 bytes_invalid=0 send_seq=321 receive_seq=321 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998268  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=16.236 memavail=1734872 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 521.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5978 bytes_read=13766 bytes_retransmit=9 bytes_invalid=0 send_seq=322 receive_seq=322 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998273  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=16.259 memavail=1735652 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 522.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5984 bytes_read=13917 bytes_retransmit=9 bytes_invalid=0 send_seq=323 receive_seq=323 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998273  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=16.280 memavail=1735148 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 523.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5990 bytes_read=14097 bytes_retransmit=9 bytes_invalid=0 send_seq=324 receive_seq=324 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998272  orange_pi: temp=43.1 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.20 cputime=16.301 memavail=1733888 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 524.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=5996 bytes_read=14278 bytes_retransmit=9 bytes_invalid=0 send_seq=325 receive_seq=325 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998271  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=16.322 memavail=1733384 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 525.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6002 bytes_read=14429 bytes_retransmit=9 bytes_invalid=0 send_seq=326 receive_seq=326 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998271  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.18 cputime=16.344 memavail=1733132 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 526.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6008 bytes_read=14595 bytes_retransmit=9 bytes_invalid=0 send_seq=327 receive_seq=327 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.18 cputime=16.365 memavail=1732880 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 527.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6014 bytes_read=14776 bytes_retransmit=9 bytes_invalid=0 send_seq=328 receive_seq=328 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=42.5 chamber_heater: target=0 temp=27.4 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.18 cputime=16.387 memavail=1733656 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 528.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6020 bytes_read=14941 bytes_retransmit=9 bytes_invalid=0 send_seq=329 receive_seq=329 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998269  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=16.408 memavail=1733404 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 529.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6026 bytes_read=15107 bytes_retransmit=9 bytes_invalid=0 send_seq=330 receive_seq=330 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998271  orange_pi: temp=43.0 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.18 cputime=16.429 memavail=1733156 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 530.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6032 bytes_read=15288 bytes_retransmit=9 bytes_invalid=0 send_seq=331 receive_seq=331 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=16.450 memavail=1733156 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 531.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6038 bytes_read=15431 bytes_retransmit=9 bytes_invalid=0 send_seq=332 receive_seq=332 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998270  orange_pi: temp=42.3 chamber_heater: target=0 temp=27.3 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.17 cputime=16.471 memavail=1732924 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 532.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000013 bytes_write=6044 bytes_read=15585 bytes_retransmit=9 bytes_invalid=0 send_seq=333 receive_seq=333 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998271  orange_pi: temp=42.9 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=16.492 memavail=1732164 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 533.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=6050 bytes_read=15768 bytes_retransmit=9 bytes_invalid=0 send_seq=334 receive_seq=334 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998273  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.17 cputime=16.515 memavail=1731160 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 534.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=6056 bytes_read=15909 bytes_retransmit=9 bytes_invalid=0 send_seq=335 receive_seq=335 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998274  orange_pi: temp=42.7 chamber_heater: target=0 temp=27.1 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=16.536 memavail=1730656 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 535.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=6062 bytes_read=16075 bytes_retransmit=9 bytes_invalid=0 send_seq=336 receive_seq=336 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=42.6 chamber_heater: target=0 temp=27.0 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.16 cputime=16.558 memavail=1730152 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 536.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=6068 bytes_read=16256 bytes_retransmit=9 bytes_invalid=0 send_seq=337 receive_seq=337 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998275  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.16 cputime=16.580 memavail=1729648 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 537.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=6074 bytes_read=16407 bytes_retransmit=9 bytes_invalid=0 send_seq=338 receive_seq=338 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998274  orange_pi: temp=42.4 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.16 cputime=16.602 memavail=1729144 print_time=5.407 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 842.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000018 mcu_task_stddev=0.000012 bytes_write=7956 bytes_read=67619 bytes_retransmit=9 bytes_invalid=0 send_seq=648 receive_seq=648 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=42.7 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.04 cputime=22.869 memavail=1727860 print_time=369.337 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
webhooks client 281473465977920: Disconnected
Restarting printer
Start printer at Sun Dec 29 21:47:47 2024 (1735498067.8 843.2)
===== Config file =====
[virtual_sdcard]
path = /home/klipper/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	TURN_OFF_HEATERS
	M107
	G91
	G1 E-{E} F1500
	G90
	CLEAR_PAUSE
	SDCARD_RESET_FILE
	BASE_CANCEL_PRINT
	PARK

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = BASE_PAUSE
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	SAVE_GCODE_STATE NAME=PAUSE_STATE
	BASE_PAUSE
	G91
	G1 E-{E} F1500
	G90
	PARK

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = BASE_RESUME
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	G91
	G1 E{E} F1500
	G90
	RESTORE_GCODE_STATE NAME=PAUSE_STATE MOVE=1
	BASE_RESUME

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro Backup_on_GitHub]
gcode = 
	{% set message = params.MESSAGE|default() %}
	{% if message %}
	RUN_SHELL_COMMAND CMD=update_git_script_message PARAMS="'{params.MESSAGE}'"
	{% else %}
	RUN_SHELL_COMMAND CMD=update_git_script
	{% endif %}

[gcode_macro list_sensors]
gcode = 
	{ action_respond_info(printer.heaters.available_heaters | join(', ')) }
	{ action_respond_info(printer.heaters.available_sensors | join(', ')) }

[gcode_macro Power_OFF]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro _POWER_OFF_PRINTER]
gcode = SET_PIN PIN=Power VALUE=0

[gcode_macro ACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60

[gcode_macro DEACTIVATE_POWER_OFF]
gcode = 
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=0

[delayed_gcode POWER_OFF_PRINTER_CHECK_ACT]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK_ACT DURATION=60
	{% endif %}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[gcode_macro M141]
gcode = SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={params.S|default(0)}

[gcode_macro M80]
gcode = SET_PIN PIN=Power  VALUE=1

[gcode_macro M81]
gcode = 
	
	SET_PIN PIN=Power VALUE=0

[gcode_macro M486]
gcode = 
	
	
	
	
	
	
	
	
	
	
	
	{% if 'exclude_object' not in printer %}
	{action_raise_error("[exclude_object] is not enabled")}
	{% endif %}
	
	{% if 'T' in params %}
	EXCLUDE_OBJECT RESET=1
	
	{% for i in range(params.T | int) %}
	EXCLUDE_OBJECT_DEFINE NAME={i}
	{% endfor %}
	{% endif %}
	
	{% if 'C' in params %}
	EXCLUDE_OBJECT CURRENT=1
	{% endif %}
	
	{% if 'P' in params %}
	EXCLUDE_OBJECT NAME={params.P}
	{% endif %}
	
	{% if 'S' in params %}
	{% if params.S == '-1' %}
	{% if printer.exclude_object.current_object %}
	EXCLUDE_OBJECT_END NAME={printer.exclude_object.current_object}
	{% endif %}
	{% else %}
	EXCLUDE_OBJECT_START NAME={params.S}
	{% endif %}
	{% endif %}
	
	{% if 'U' in params %}
	EXCLUDE_OBJECT RESET=1 NAME={params.U}
	{% endif %}

[gcode_macro M190]
rename_existing = M190.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M190.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _CHOME]
gcode = 
	{% if printer["gcode_macro status_homing"] != null %}
	status_homing
	{% endif %}
	{% if printer.toolhead.homed_axes != "xyz" %}
	G28
	{% endif %}
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro M109]
rename_existing = M109.1
gcode = 
	{% if printer["gcode_macro status_heating"] != null %}
	status_heating
	{% endif %}
	M109.1 { rawparams }
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro _MOVE_AWAY]
gcode = 
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	G90
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000

[gcode_macro PARK_CENTER_REAR]
gcode = 
	{% if printer["gcode_macro status_busy"] != null %}
	status_busy
	{% endif %}
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	{% if printer["gcode_macro status_ready"] != null %}
	status_ready
	{% endif %}

[gcode_macro START_PRINT]
variable_retract = 15
gcode = 
	{% set chamber_temp = params.CHAMBER_TEMP|default(0)|float %}
	{% set extruder_temp = params.EXTRUDER_TEMP|default(210)|float %}
	{% set bed_temp = params.BED_TEMP|default(60)|float %}
	{% set E = printer["gcode_macro START_PRINT"].retract|float %}
	CLEAR_PAUSE
	G28
	Smart_Park
	M220 S100
	M221 S100
	SET_HEATER_TEMPERATURE HEATER=chamber_heater TARGET={chamber_temp}
	SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={bed_temp}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp * 0.75}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	G90
	M82
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bed_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	G92 E0
	
	G1 E-15 F2000
	
	G92 E0
	G28
	BED_MESH_CALIBRATE
	PRIME_LINE

[gcode_macro pid_soplo]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=250

[gcode_macro pid_bed]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=105

[gcode_macro BED]
gcode = 
	PROBE_CALIBRATE

[gcode_macro END_PRINT]
gcode = 
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 2) %}
	{% set z_safe = 2.0 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	
	M400
	G92 E0
	G1 E-15 F3600
	G91
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	
	
	M104 S0
	M104 S0
	M140 S0
	M106 S0
	G90
	G0 X{max_x / 2} Y{max_y} F3600
	
	SONG_CRAB_RAVE
	
	
	
	M117 Finished!
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	
	
	{% set V = params.V|default(99)|int %}
	SET_PIN PIN=beeper VALUE={0.1 * (V / 100) if S > 0 else 1} CYCLE_TIME={ 1.0 / S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
description = 
	"Plays a beep sound.
	@param {int} [S=1000] - Frequency in Hz
	@param {int} [P=100] - Duration in ms
	@param {int} [V=99] - Volume in percent"

[gcode_macro PRIME_LINE]
gcode = 
	{% set feedrate = params.F|default(10)|float * 60 %}
	{% set length = 100.0 %}
	{% set width = printer.configfile.settings.extruder.nozzle_diameter|float %}
	{% set height = ( (width / 0.04)|int - (width / 0.04 / 4)|int )|float * 0.04 %}
	
	{% set extrude = length * width * height * 1.5 %}
	SAVE_GCODE_STATE NAME=PRIME_LINE_STATE
	SET_IDLE_TIMEOUT TIMEOUT=7200
	{% if 'Y' in params %}
	{% set x_start = 1.0 %}
	{% set y_start = (printer.toolhead.axis_maximum.y|float - 100) / 2 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 Y100 E{extrude} F{feedrate}
	G0 X{width} F5000
	G1 Y-100 E{extrude} F{feedrate}
	{% else %}
	{% set x_start = (printer.toolhead.axis_maximum.x|float - 100) / 2 %}
	{% set y_start = 1.0 %}
	G0 X{x_start} Y{y_start} F5000
	G0 Z{height} F1500
	G91
	
	G1 E8 F300
	
	
	G1 X100 E{extrude} F{feedrate}
	G0 Y{width} F5000
	G1 X-100 E{extrude} F{feedrate}
	{% endif %}
	RESTORE_GCODE_STATE NAME=PRIME_LINE_STATE

[gcode_macro VINT]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro LOW_TEMP_CHECK]
gcode = 
	{% set extruder_temp = params.T|default(240)|float %}
	{% if printer.extruder.target > extruder_temp %}
	{% set extruder_temp = printer.extruder.target %}
	{% endif %}
	{% if printer.extruder.temperature < extruder_temp %}
	M118 Heating to {extruder_temp}
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET={extruder_temp}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={extruder_temp}
	{% endif %}

[gcode_macro M76]
gcode = 
	PAUSE

[gcode_macro M601]
gcode = 
	PAUSE

[gcode_macro G27]
gcode = 
	PARK

[gcode_macro M125]
gcode = 
	PARK

[gcode_macro M600]
gcode = 
	PAUSE

[gcode_macro M701]
gcode = 
	FILAMENT_LOAD

[gcode_macro M702]
gcode = 
	FILAMENT_UNLOAD

[gcode_macro M500]
gcode = 
	SAVE_CONFIG

[gcode_macro PARK]
gcode = 
	{% set x_park = params.X|default(0)|float %}
	{% set y_park = params.Y|default(0)|float %}
	{% set z_park = params.Z|default(10)|float + printer.toolhead.position.z|float %}
	{% set x_max = printer.toolhead.axis_maximum.x|float %}
	{% set y_max = printer.toolhead.axis_maximum.y|float %}
	{% set z_max = printer.toolhead.axis_maximum.z|float %}
	{% if x_park > x_max %}
	{% set x_park = x_max %}
	{% endif %}
	{% if y_park > y_max %}
	{% set y_park = y_max %}
	{% endif %}
	{% if z_park > z_max %}
	{% set z_park = z_max %}
	{% endif %}
	SAVE_GCODE_STATE NAME=PARK_STATE
	G90
	G1 Z{z_park} F1500
	G1 X{x_park} Y{y_park} F5000
	RESTORE_GCODE_STATE name=PARK_STATE

[gcode_macro START_DRYER]
description = Start the heated bed filament dryer.
gcode = 
	{% set ChamberTemperature = params.CHAMBER | default(65.0) | float %}
	{% set BedTemperature = params.TEMPERATURE | default(0.0) | float %}
	{% set DryTime = params.TIME | default(14400) | int %}
	M140 S{BedTemperature}
	M141 S{ChamberTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={DryTime}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=bed_temperature VALUE={BedTemperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=chamber_temperature VALUE={ChamberTemperature}
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1

[gcode_macro STOP_DRYER]
gcode = 
	M140 S0
	M141 S0
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE=0
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=0
	M117 Drying Stopped

[gcode_macro DRYER_STATUS]
variable_time_remaining = 0
variable_bed_temperature = 0
variable_chamber_temperature = 0
gcode = 
	{% if time_remaining > 0 %}
	M140 S{bed_temperature}
	SET_GCODE_VARIABLE MACRO=DRYER_STATUS VARIABLE=time_remaining VALUE={time_remaining - 1}
	M117 Drying {time_remaining}
	{% else %}
	STOP_DRYER
	{% endif %}

[delayed_gcode DRYER_TIMER]
gcode = 
	UPDATE_DELAYED_GCODE ID=DRYER_TIMER DURATION=1
	DRYER_STATUS

[gcode_macro DRY_tpu]
gcode = 
	START_DRYER TEMPERATURE=0 CHAMBER=50 TIME=18000

[gcode_macro DRY_PETG]
gcode = 
	START_DRYER TEMPERATURE=0  CHAMBER=65 TIME=18000

[gcode_macro DRY_ABS]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M4]
gcode = 
	{% set S = params.S|default(0.0)|float %}
	SET_PIN PIN=Laser VALUE={S / 255.0}

[gcode_macro M5]
gcode = 
	SET_PIN PIN=Laser VALUE=0

[menu __main __control __toolonoff]
type = input
enable = {'pwm_tool Laser' in printer}
name = Fan: {'ON ' if menu.input else 'OFF'}
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 1
gcode = 
	M3 S{255 if menu.input else 0}

[menu __main __control __toolspeed]
type = input
enable = {'pwm_tool Laser' in printer}
name = Laser speed: {'%3d' % (menu.input*100)}%
input = {printer['pwm_tool Laser'].value}
input_min = 0
input_max = 1
input_step = 0.01
gcode = 
	M3 S{'%d' % (menu.input*255)}

[gcode_macro NOTE]
description = 
	"Plays a specified note for a specified duration
	@param {string} [N=C5] - Note to play
	@param {int} [D=500] - Duration of note. There are currently some Klipper limitations to how short a note can be.
	@param {int} [V=99] - Volume in percent
	@param {bool} [S=true] - Whether or not to stop the note after duration"
gcode = 
	{% set notes = {
	'C0': 16.35,   'CS0': 17.32,   'D0': 18.35,   'DS0': 19.45,   'E0': 20.60,   'F0': 21.83,   'FS0': 23.12,   'G0': 24.50,   'GS0': 25.96,   'A0': 27.50,   'AS0': 29.14,   'B0': 30.87,
	'C1': 32.70,   'CS1': 34.65,   'D1': 36.71,   'DS1': 38.89,   'E1': 41.20,   'F1': 43.65,   'FS1': 46.25,   'G1': 49.00,   'GS1': 51.91,   'A1': 55.00,   'AS1': 58.27,   'B1': 61.74,
	'C2': 65.41,   'CS2': 69.30,   'D2': 73.42,   'DS2': 77.78,   'E2': 82.41,   'F2': 87.31,   'FS2': 92.50,   'G2': 98.00,   'GS2': 103.83,  'A2': 110.00,  'AS2': 116.54,  'B2': 123.47,
	'C3': 130.81,  'CS3': 138.59,  'D3': 146.83,  'DS3': 155.56,  'E3': 164.81,  'F3': 174.61,  'FS3': 185.00,  'G3': 196.00,  'GS3': 207.65,  'A3': 220.00,  'AS3': 233.08,  'B3': 246.94,
	'C4': 261.63,  'CS4': 277.18,  'D4': 293.66,  'DS4': 311.13,  'E4': 329.63,  'F4': 349.23,  'FS4': 369.99,  'G4': 392.00,  'GS4': 415.30,  'A4': 440.00,  'AS4': 466.16,  'B4': 493.88,
	'C5': 523.25,  'CS5': 554.37,  'D5': 587.33,  'DS5': 622.25,  'E5': 659.26,  'F5': 698.46,  'FS5': 739.99,  'G5': 783.99,  'GS5': 830.61,  'A5': 880.00,  'AS5': 932.33,  'B5': 987.77,
	'C6': 1046.50, 'CS6': 1108.73, 'D6': 1174.66, 'DS6': 1244.51, 'E6': 1318.51, 'F6': 1396.91, 'FS6': 1479.98, 'G6': 1567.98, 'GS6': 1661.22, 'A6': 1760.00, 'AS6': 1864.66, 'B6': 1975.53,
	'C7': 2093.00, 'CS7': 2217.46, 'D7': 2349.32, 'DS7': 2489.02, 'E7': 2637.02, 'F7': 2793.83, 'FS7': 2959.96, 'G7': 3135.96, 'GS7': 3322.44, 'A7': 3520.00, 'AS7': 3729.31, 'B7': 3951.07,
	'C8': 4186.01, 'CS8': 4434.92, 'D8': 4698.64, 'DS8': 4978.03, 'E8': 5274.04, 'F8': 5587.65, 'FS8': 5919.91, 'G8': 6271.93, 'GS8': 6644.88, 'A8': 7040.00, 'AS8': 7458.62, 'B8': 7902.13,
	} %}
	
	{% set note = params.N|default('C5')|string %}
	
	{% set dur = params.D|default(500)|int %}
	
	
	{% set volume = params.V|default(99)|int %}
	
	{% set stop = params.S|default('true')|string %}
	
	{% set freq = notes[note] %}
	
	SET_PIN PIN=beeper VALUE={0.1 * (volume / 100) if volume > 0 else 1} CYCLE_TIME={ 1.0 / freq }
	G4 P{dur}
	{% if stop|lower == 'true' %}
	SET_PIN PIN=beeper VALUE=0 CYCLE_TIME={ 0.001 }
	{% endif %}

[gcode_macro TONE_GEN]
description = "Used for the tone generator menu"
variable_tone_freq = 0.001093
gcode = 
	M117 {printer["gcode_macro TONE_GEN"].tone_freq}nothz

[gcode_macro SONG_STAR_WARS_MAIN_THEME]
description = "Plays the Star Wars main theme"
gcode = 
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=D4 D=133
	NOTE N=G4 D=1000
	NOTE N=D5 D=1000
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=A4 D=133
	NOTE N=G5 D=1000
	NOTE N=D5 D=500
	
	NOTE N=C5 D=133
	NOTE N=B4 D=133
	NOTE N=C5 D=133
	NOTE N=A4 D=1000

[gcode_macro SONG_CRAB_RAVE]
description = "Plays Crab Rave"
gcode = 
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=AS6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=1
	NOTE N=G6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=D6 D=150 V=30 S=1
	NOTE N=D6 D=150 V=30 S=0
	NOTE N=A6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=1
	NOTE N=F6 D=150 V=30 S=0
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=C6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=1
	NOTE N=E6 D=150 V=30 S=0
	NOTE N=F6 D=150 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro one]
description = "one"
gcode = 
	NOTE N=C6 D=600 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=E6 D=400 V=30 S=1
	G4 P150
	NOTE N=G6 D=180 V=30 S=0
	NOTE N=F6 D=180 V=30 S=0
	NOTE N=E6 D=180 V=30 S=0
	NOTE N=D6 D=180 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=G5 D=400 V=30 S=1
	NOTE N=D6 D=600 V=30 S=1
	NOTE N=C6 D=600 V=30 S=1
	SET_PIN PIN=beeper VALUE=0

[gcode_macro SONG_BOOMER]
description = "BOOMER"
gcode = 
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S659
	M300 P207 S784
	M300 P207 S494
	M300 P207 S494
	M300 P207 S392
	M300 P207 S494
	M300 P207 S494
	M300 P207 S330
	M300 P207 S784
	M300 P207 S659
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S784
	M300 P207 S880
	M300 P207 S988
	M300 P207 S523
	M300 P207 S523
	M300 P207 S392
	M300 P207 S523
	M300 P207 S523
	M300 P207 S330

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION=0.5
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 0.0
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[exclude_object]

[led_effect panel_idle]
autostart = true
frame_rate = 24
leds = 
	neopixel:panel_ring
layers = 
	breathing  10 1 top (.5,.5,1)

[gcode_shell_command update_git_script]
command = bash -c "bash $HOME/klipper-backup/script.sh"
timeout = 90.0
verbose = True

[gcode_shell_command update_git_script_message]
command = bash -c "bash $HOME/klipper-backup/script.sh -c \"$0\""
timeout = 90.0
verbose = True

[neopixel panel_ring]
pin = PA8
chain_count = 16

[mcu]
serial = /dev/ttyS3
restart_method = command

[output_pin Power]
pin = PC12
value = 1
shutdown_value = 1

[temperature_sensor orange_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[heater_generic chamber_heater]
heater_pin = !PA7
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA5
control = watermark
max_power = 1
min_temp = 15
max_temp = 85

[verify_heater chamber_heater]
max_error = 9999
check_gain_time = 9999
hysteresis = 5
heating_gain = 2

[filament_motion_sensor motion_sensor]
detection_length = 50
extruder = extruder
switch_pin = !PC15
pause_on_runout = True
runout_gcode = 
	SONG_CRAB_RAVE

[bltouch]
sensor_pin = ^PC14
control_pin = PA1
x_offset = -40
y_offset = 0.000
z_offset = 1.70
pin_up_reports_not_triggered = False
probe_with_touch_mode = True

[heater_bed]
heater_pin = PC9
sensor_type = ATC Semitec 104GT-2
sensor_pin = PC3
control = pid
pid_kp = 72.553
pid_ki = 1.154
pid_kd = 1139.994
min_temp = 5
max_temp = 125

[heater_fan radiator]
pin = PC7
max_power = 1.0
kick_start_time = 0.600
heater = extruder
heater_temp = 50.0
shutdown_speed = 1

[fan]
pin = PC6

[input_shaper]
shaper_type_x = 2hump_ei
shaper_freq_x = 43.0
shaper_type_y = mzv
shaper_freq_y = 32.6

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 1900
max_z_velocity = 30
max_z_accel = 100
square_corner_velocity = 4

[bed_mesh]
speed = 150
horizontal_move_z = 9
mesh_min = 10, 20
mesh_max = 195, 210
probe_count = 5
mesh_pps = 2, 3
algorithm = bicubic
bicubic_tension = 0.2
move_check_distance = 9
split_delta_z = .025
fade_start = 1
fade_end = 10
fade_target = 0

[screws_tilt_adjust]
screw1 = 79, 27
screw1_name = Peredniy Leviy
screw2 = 235, 27
screw2_name = Peredniy Praviy
screw3 = 235,197
screw3_name = Zadniy Praviy
screw4 = 79,197
screw4_name = Zadniy Leviy
speed = 120
horizontal_move_z = 9

[safe_z_home]
home_xy_position = 157,115
speed = 50
z_hop = 9.0
z_hop_speed = 20.0

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC0
position_endstop = 0
position_max = 240
position_min = -2
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
endstop_pin = ^PC1
position_endstop = 0
homing_retract_dist = 5
homing_speed = 50
second_homing_speed = 10
position_max = 231
position_min = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.6
stealthchop_threshold = 999999

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 40
gear_ratio = 80:16
full_steps_per_rotation = 200
endstop_pin = probe:z_virtual_endstop
homing_retract_dist = 9
second_homing_speed = 10
position_min = -5
position_max = 245
homing_speed = 50

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
stealthchop_threshold = 999999
interpolate = false

[extruder]
step_pin = PB3
dir_pin = PB4
enable_pin = !PD2
microsteps = 16
rotation_distance = 4.637
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PC8
sensor_type = ATC Semitec 104GT-2
sensor_pin = PA0
min_temp = 5
max_temp = 270
max_extrude_only_velocity = 120
max_extrude_only_accel = 3000
pressure_advance = 0.031
full_steps_per_rotation = 200
control = pid
pid_kp = 29.662
pid_ki = 2.382
pid_kd = 92.322

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
run_current = 0.7
stealthchop_threshold = 999999

[static_digital_output usb_pullup_enable]
pins = !PA14

[board_pins]
aliases = 
	
	EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8,  EXP1_9=<GND>,
	EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PB15, EXP1_10=<5V>

[display]
lcd_type = st7920
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[pwm_cycle_time beeper]
pin = EXP1_1
shutdown_value = 0
cycle_time = 0.001

[firmware_retraction]
retract_length = 1.0
retract_speed = 80
unretract_extra_length = 0
unretract_speed = 80

[pwm_tool Laser]
pin = PA6
cycle_time = 0.0001
shutdown_value = 0
maximum_mcu_duration = 5

[bed_mesh 70]
version = 1
points = 
	-0.045000, 0.027500, 0.015000
	-0.055000, -0.005000, -0.035000
	-0.007500, 0.040000, -0.002500
x_count = 3
y_count = 3
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0

[bed_mesh default]
version = 1
points = 
	0.020000, 0.025000, 0.030000, -0.007500, -0.052500
	0.015000, 0.017500, 0.022500, -0.007500, -0.057500
	0.030000, 0.030000, 0.037500, 0.002500, -0.035000
	0.012500, 0.030000, 0.050000, 0.035000, -0.010000
	0.080000, 0.087500, 0.115000, 0.097500, 0.067500
x_count = 5
y_count = 5
mesh_x_pps = 2
mesh_y_pps = 3
algo = bicubic
tension = 0.2
min_x = 10.0
max_x = 195.0
min_y = 20.0
max_y = 210.0
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 281473444406240: New connection
webhooks client 281473444406240: Client info {'program': 'Moonraker', 'version': 'v0.9.3-4-ga4604e3'}
mcu 'mcu': got {'oid': 27, 'next_clock': 1163236224, 'value': 31240, '#name': 'analog_in_state', '#sent_time': 846.4490135279999, '#receive_time': 846.501444028}
mcu 'mcu': got {'oid': 15, 'next_clock': 1176196224, 'value': 31162, '#name': 'analog_in_state', '#sent_time': 846.657791861, '#receive_time': 846.680805736}
mcu 'mcu': got {'oid': 19, 'next_clock': 1179076224, 'value': 31236, '#name': 'analog_in_state', '#sent_time': 846.7095723609999, '#receive_time': 846.720809236}
mcu 'mcu': got {'oid': 27, 'next_clock': 1184836224, 'value': 31239, '#name': 'analog_in_state', '#sent_time': 846.761378694, '#receive_time': 846.800864361}
Loaded MCU 'mcu' 118 commands (v0.12.0-404-g80d185c94 / gcc: (15:12.2.rel1-1) 12.2.1 20221205 binutils: (2.40-2+18+b1) 2.40)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 INITIAL_PINS=!PA14 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA3,PA2 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Starting heater checks for chamber_heater
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (50.0, 20.0)    | (10.0, 20.0)
  1   | (96.2, 20.0)    | (56.2, 20.0)
  2   | (142.5, 20.0)   | (102.5, 20.0)
  3   | (188.8, 20.0)   | (148.8, 20.0)
  4   | (235.0, 20.0)   | (195.0, 20.0)
  5   | (235.0, 67.5)   | (195.0, 67.5)
  6   | (188.8, 67.5)   | (148.8, 67.5)
  7   | (142.5, 67.5)   | (102.5, 67.5)
  8   | (96.2, 67.5)    | (56.2, 67.5)
  9   | (50.0, 67.5)    | (10.0, 67.5)
  10  | (50.0, 115.0)   | (10.0, 115.0)
  11  | (96.2, 115.0)   | (56.2, 115.0)
  12  | (142.5, 115.0)  | (102.5, 115.0)
  13  | (188.8, 115.0)  | (148.8, 115.0)
  14  | (235.0, 115.0)  | (195.0, 115.0)
  15  | (235.0, 162.5)  | (195.0, 162.5)
  16  | (188.8, 162.5)  | (148.8, 162.5)
  17  | (142.5, 162.5)  | (102.5, 162.5)
  18  | (96.2, 162.5)   | (56.2, 162.5)
  19  | (50.0, 162.5)   | (10.0, 162.5)
  20  | (50.0, 210.0)   | (10.0, 210.0)
  21  | (96.2, 210.0)   | (56.2, 210.0)
  22  | (142.5, 210.0)  | (102.5, 210.0)
  23  | (188.8, 210.0)  | (148.8, 210.0)
  24  | (235.0, 210.0)  | (195.0, 210.0)
Starting heater checks for extruder
Stats 847.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3089 bytes_read=6251 bytes_retransmit=9 bytes_invalid=0 send_seq=218 receive_seq=215 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=1909 upcoming_bytes=272 freq=71993829  orange_pi: temp=43.7 chamber_heater: target=0 temp=0.0 pwm=0.000 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.20 cputime=25.964 memavail=1728764 print_time=374.877 buffer_time=0.240 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473444406240
webhooks: registering remote method 'reboot_machine' for connection id: 281473444406240
webhooks: registering remote method 'pause_job_queue' for connection id: 281473444406240
webhooks: registering remote method 'start_job_queue' for connection id: 281473444406240
Stats 848.4: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000123 mcu_task_stddev=0.000268 bytes_write=7099 bytes_read=7184 bytes_retransmit=9 bytes_invalid=0 send_seq=321 receive_seq=320 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=11 upcoming_bytes=0 freq=71996069  orange_pi: temp=43.5 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=26.067 memavail=1728316 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 849.4: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000123 mcu_task_stddev=0.000268 bytes_write=9017 bytes_read=8076 bytes_retransmit=9 bytes_invalid=0 send_seq=395 receive_seq=394 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997167  orange_pi: temp=43.5 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.20 cputime=26.161 memavail=1728256 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Neopixel update did not succeed
Stats 850.4: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000123 mcu_task_stddev=0.000268 bytes_write=10814 bytes_read=8973 bytes_retransmit=9 bytes_invalid=0 send_seq=463 receive_seq=463 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997538  orange_pi: temp=43.5 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=26.241 memavail=1728116 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 851.4: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000123 mcu_task_stddev=0.000268 bytes_write=12767 bytes_read=9982 bytes_retransmit=9 bytes_invalid=0 send_seq=543 receive_seq=543 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997713  orange_pi: temp=43.3 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.6 pwm=0.000 sysload=1.18 cputime=26.326 memavail=1728368 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 852.4: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000123 mcu_task_stddev=0.000268 bytes_write=14388 bytes_read=10646 bytes_retransmit=9 bytes_invalid=0 send_seq=597 receive_seq=597 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997803  orange_pi: temp=43.2 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.18 cputime=26.397 memavail=1728116 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 853.4: gcodein=0  mcu: mcu_awake=0.121 mcu_task_avg=0.000244 mcu_task_stddev=0.000268 bytes_write=15792 bytes_read=11264 bytes_retransmit=9 bytes_invalid=0 send_seq=642 receive_seq=642 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71997897  orange_pi: temp=42.5 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=26.463 memavail=1727108 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 854.4: gcodein=0  mcu: mcu_awake=0.121 mcu_task_avg=0.000244 mcu_task_stddev=0.000268 bytes_write=17769 bytes_read=12346 bytes_retransmit=9 bytes_invalid=0 send_seq=728 receive_seq=727 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997939  orange_pi: temp=42.9 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=26.550 memavail=1727124 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Neopixel update did not succeed
Stats 855.4: gcodein=0  mcu: mcu_awake=0.121 mcu_task_avg=0.000244 mcu_task_stddev=0.000268 bytes_write=19776 bytes_read=13470 bytes_retransmit=9 bytes_invalid=0 send_seq=818 receive_seq=817 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71997965  orange_pi: temp=43.5 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.18 cputime=26.641 memavail=1726408 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Neopixel update did not succeed
Stats 856.4: gcodein=0  mcu: mcu_awake=0.121 mcu_task_avg=0.000244 mcu_task_stddev=0.000268 bytes_write=21696 bytes_read=14520 bytes_retransmit=9 bytes_invalid=0 send_seq=899 receive_seq=899 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998011  orange_pi: temp=43.0 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=26.728 memavail=1726408 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 857.4: gcodein=0  mcu: mcu_awake=0.121 mcu_task_avg=0.000244 mcu_task_stddev=0.000268 bytes_write=23555 bytes_read=15451 bytes_retransmit=9 bytes_invalid=0 send_seq=973 receive_seq=973 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998670  orange_pi: temp=43.2 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=26.807 memavail=1726408 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 858.4: gcodein=0  mcu: mcu_awake=0.140 mcu_task_avg=0.000259 mcu_task_stddev=0.000263 bytes_write=24979 bytes_read=16229 bytes_retransmit=9 bytes_invalid=0 send_seq=1032 receive_seq=1032 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998522  orange_pi: temp=43.2 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=26.877 memavail=1726412 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Neopixel update did not succeed
Stats 859.4: gcodein=0  mcu: mcu_awake=0.140 mcu_task_avg=0.000259 mcu_task_stddev=0.000263 bytes_write=26988 bytes_read=17357 bytes_retransmit=9 bytes_invalid=0 send_seq=1120 receive_seq=1120 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998460  orange_pi: temp=43.3 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.17 cputime=26.967 memavail=1726412 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 860.4: gcodein=0  mcu: mcu_awake=0.140 mcu_task_avg=0.000259 mcu_task_stddev=0.000263 bytes_write=28836 bytes_read=18270 bytes_retransmit=9 bytes_invalid=0 send_seq=1193 receive_seq=1192 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998378  orange_pi: temp=43.2 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=27.046 memavail=1725908 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.5 pwm=0.000
Stats 861.4: gcodein=0  mcu: mcu_awake=0.140 mcu_task_avg=0.000259 mcu_task_stddev=0.000263 bytes_write=30657 bytes_read=19061 bytes_retransmit=9 bytes_invalid=0 send_seq=1257 receive_seq=1257 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998326  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=27.121 memavail=1725404 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 862.4: gcodein=0  mcu: mcu_awake=0.140 mcu_task_avg=0.000259 mcu_task_stddev=0.000263 bytes_write=32512 bytes_read=19934 bytes_retransmit=9 bytes_invalid=0 send_seq=1327 receive_seq=1326 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998289  orange_pi: temp=43.4 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.23 cputime=27.197 memavail=1725924 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 863.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000251 mcu_task_stddev=0.000266 bytes_write=33848 bytes_read=20662 bytes_retransmit=9 bytes_invalid=0 send_seq=1380 receive_seq=1380 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998285  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.23 cputime=27.267 memavail=1725168 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 864.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000251 mcu_task_stddev=0.000266 bytes_write=35725 bytes_read=21552 bytes_retransmit=9 bytes_invalid=0 send_seq=1452 receive_seq=1452 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998280  orange_pi: temp=44.0 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.23 cputime=27.367 memavail=1725200 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 865.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000251 mcu_task_stddev=0.000266 bytes_write=37562 bytes_read=22386 bytes_retransmit=9 bytes_invalid=0 send_seq=1518 receive_seq=1518 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998278  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.23 cputime=27.443 memavail=1725476 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 866.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000251 mcu_task_stddev=0.000266 bytes_write=39578 bytes_read=23512 bytes_retransmit=9 bytes_invalid=0 send_seq=1607 receive_seq=1607 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998261  orange_pi: temp=43.3 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.21 cputime=27.531 memavail=1725224 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 867.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000251 mcu_task_stddev=0.000266 bytes_write=41478 bytes_read=24485 bytes_retransmit=9 bytes_invalid=0 send_seq=1686 receive_seq=1686 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=71998246  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.21 cputime=27.614 memavail=1726028 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 868.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000250 mcu_task_stddev=0.000265 bytes_write=42758 bytes_read=25119 bytes_retransmit=9 bytes_invalid=0 send_seq=1731 receive_seq=1731 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998242  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=27.679 memavail=1726552 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 869.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000250 mcu_task_stddev=0.000265 bytes_write=44632 bytes_read=25977 bytes_retransmit=9 bytes_invalid=0 send_seq=1800 receive_seq=1800 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998233  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.9 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.21 cputime=27.757 memavail=1726824 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 870.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000250 mcu_task_stddev=0.000265 bytes_write=46345 bytes_read=26625 bytes_retransmit=9 bytes_invalid=0 send_seq=1854 receive_seq=1854 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998227  orange_pi: temp=42.9 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.21 cputime=27.828 memavail=1726588 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 871.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000250 mcu_task_stddev=0.000265 bytes_write=48320 bytes_read=27727 bytes_retransmit=9 bytes_invalid=0 send_seq=1940 receive_seq=1940 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998221  orange_pi: temp=42.9 chamber_heater: target=0 temp=26.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=27.915 memavail=1726864 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 872.4: gcodein=0  mcu: mcu_awake=0.131 mcu_task_avg=0.000250 mcu_task_stddev=0.000265 bytes_write=50168 bytes_read=28559 bytes_retransmit=9 bytes_invalid=0 send_seq=2007 receive_seq=2007 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998221  orange_pi: temp=43.0 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=26.0 pwm=0.000 sysload=1.20 cputime=27.994 memavail=1727112 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 873.4: gcodein=0  mcu: mcu_awake=0.114 mcu_task_avg=0.000232 mcu_task_stddev=0.000265 bytes_write=51481 bytes_read=29168 bytes_retransmit=9 bytes_invalid=0 send_seq=2053 receive_seq=2053 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998221  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.20 cputime=28.060 memavail=1726392 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 874.4: gcodein=0  mcu: mcu_awake=0.114 mcu_task_avg=0.000232 mcu_task_stddev=0.000265 bytes_write=53255 bytes_read=29971 bytes_retransmit=9 bytes_invalid=0 send_seq=2116 receive_seq=2116 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998220  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.6 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.20 cputime=28.139 memavail=1726676 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 875.4: gcodein=0  mcu: mcu_awake=0.114 mcu_task_avg=0.000232 mcu_task_stddev=0.000265 bytes_write=55148 bytes_read=30894 bytes_retransmit=9 bytes_invalid=0 send_seq=2190 receive_seq=2190 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998217  orange_pi: temp=42.4 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.20 cputime=28.218 memavail=1727204 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 876.4: gcodein=0  mcu: mcu_awake=0.114 mcu_task_avg=0.000232 mcu_task_stddev=0.000265 bytes_write=57043 bytes_read=31763 bytes_retransmit=9 bytes_invalid=0 send_seq=2262 receive_seq=2261 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998218  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=28.297 memavail=1727728 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.9 pwm=0.000
Stats 877.4: gcodein=0  mcu: mcu_awake=0.114 mcu_task_avg=0.000232 mcu_task_stddev=0.000265 bytes_write=58818 bytes_read=32592 bytes_retransmit=9 bytes_invalid=0 send_seq=2326 receive_seq=2326 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998226  orange_pi: temp=42.9 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=28.371 memavail=1727224 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.5 pwm=0.000
Stats 878.4: gcodein=0  mcu: mcu_awake=0.116 mcu_task_avg=0.000237 mcu_task_stddev=0.000269 bytes_write=60154 bytes_read=33279 bytes_retransmit=9 bytes_invalid=0 send_seq=2376 receive_seq=2376 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998234  orange_pi: temp=42.5 chamber_heater: target=0 temp=26.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.18 cputime=28.440 memavail=1726972 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 879.4: gcodein=0  mcu: mcu_awake=0.116 mcu_task_avg=0.000237 mcu_task_stddev=0.000269 bytes_write=62077 bytes_read=34213 bytes_retransmit=9 bytes_invalid=0 send_seq=2452 receive_seq=2452 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998232  orange_pi: temp=42.9 chamber_heater: target=0 temp=26.7 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.18 cputime=28.521 memavail=1726496 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 880.4: gcodein=0  mcu: mcu_awake=0.116 mcu_task_avg=0.000237 mcu_task_stddev=0.000269 bytes_write=63816 bytes_read=34985 bytes_retransmit=9 bytes_invalid=0 send_seq=2512 receive_seq=2512 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998234  orange_pi: temp=43.3 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.18 cputime=28.596 memavail=1726248 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.5 pwm=0.000
Stats 881.4: gcodein=0  mcu: mcu_awake=0.116 mcu_task_avg=0.000237 mcu_task_stddev=0.000269 bytes_write=65650 bytes_read=35773 bytes_retransmit=9 bytes_invalid=0 send_seq=2575 receive_seq=2575 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998233  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=28.671 memavail=1726252 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 882.4: gcodein=0  mcu: mcu_awake=0.116 mcu_task_avg=0.000237 mcu_task_stddev=0.000269 bytes_write=67546 bytes_read=36655 bytes_retransmit=9 bytes_invalid=0 send_seq=2648 receive_seq=2647 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998233  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.2 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.17 cputime=28.750 memavail=1725760 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 883.4: gcodein=0  mcu: mcu_awake=0.109 mcu_task_avg=0.000226 mcu_task_stddev=0.000265 bytes_write=68835 bytes_read=37315 bytes_retransmit=9 bytes_invalid=0 send_seq=2694 receive_seq=2694 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=71998240  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.17 cputime=28.817 memavail=1725908 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 884.4: gcodein=0  mcu: mcu_awake=0.109 mcu_task_avg=0.000226 mcu_task_stddev=0.000265 bytes_write=70692 bytes_read=38220 bytes_retransmit=9 bytes_invalid=0 send_seq=2766 receive_seq=2766 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998240  orange_pi: temp=43.0 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=28.897 memavail=1726036 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 885.4: gcodein=0  mcu: mcu_awake=0.109 mcu_task_avg=0.000226 mcu_task_stddev=0.000265 bytes_write=72521 bytes_read=39013 bytes_retransmit=9 bytes_invalid=0 send_seq=2830 receive_seq=2830 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998239  orange_pi: temp=43.2 chamber_heater: target=0 temp=26.4 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.17 cputime=28.972 memavail=1726068 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 886.4: gcodein=0  mcu: mcu_awake=0.109 mcu_task_avg=0.000226 mcu_task_stddev=0.000265 bytes_write=74522 bytes_read=40105 bytes_retransmit=9 bytes_invalid=0 send_seq=2918 receive_seq=2917 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998240  orange_pi: temp=43.0 chamber_heater: target=0 temp=26.3 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.15 cputime=29.056 memavail=1726340 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 887.4: gcodein=0  mcu: mcu_awake=0.109 mcu_task_avg=0.000226 mcu_task_stddev=0.000265 bytes_write=76436 bytes_read=41166 bytes_retransmit=9 bytes_invalid=0 send_seq=3001 receive_seq=3001 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998240  orange_pi: temp=42.8 chamber_heater: target=0 temp=26.2 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.15 cputime=29.140 memavail=1726588 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 888.4: gcodein=0  mcu: mcu_awake=0.129 mcu_task_avg=0.000248 mcu_task_stddev=0.000267 bytes_write=77695 bytes_read=41712 bytes_retransmit=9 bytes_invalid=0 send_seq=3041 receive_seq=3041 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998244  orange_pi: temp=42.7 chamber_heater: target=0 temp=26.2 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.15 cputime=29.205 memavail=1727624 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 889.4: gcodein=0  mcu: mcu_awake=0.129 mcu_task_avg=0.000248 mcu_task_stddev=0.000267 bytes_write=79522 bytes_read=42484 bytes_retransmit=9 bytes_invalid=0 send_seq=3103 receive_seq=3103 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998250  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.1 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.15 cputime=29.281 memavail=1727640 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 890.4: gcodein=0  mcu: mcu_awake=0.129 mcu_task_avg=0.000248 mcu_task_stddev=0.000267 bytes_write=81411 bytes_read=43447 bytes_retransmit=9 bytes_invalid=0 send_seq=3181 receive_seq=3181 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998250  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.9 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.15 cputime=29.364 memavail=1727896 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Neopixel update did not succeed
Stats 891.4: gcodein=0  mcu: mcu_awake=0.129 mcu_task_avg=0.000248 mcu_task_stddev=0.000267 bytes_write=83476 bytes_read=44705 bytes_retransmit=9 bytes_invalid=0 send_seq=3281 receive_seq=3281 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998249  orange_pi: temp=42.9 chamber_heater: target=0 temp=25.3 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.14 cputime=29.456 memavail=1727936 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 892.4: gcodein=0  mcu: mcu_awake=0.129 mcu_task_avg=0.000248 mcu_task_stddev=0.000267 bytes_write=85455 bytes_read=45747 bytes_retransmit=9 bytes_invalid=0 send_seq=3365 receive_seq=3365 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998326  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.0 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.14 cputime=29.539 memavail=1728216 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 893.4: gcodein=0  mcu: mcu_awake=0.135 mcu_task_avg=0.000257 mcu_task_stddev=0.000266 bytes_write=86735 bytes_read=46328 bytes_retransmit=9 bytes_invalid=0 send_seq=3408 receive_seq=3408 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998319  orange_pi: temp=42.7 chamber_heater: target=0 temp=26.0 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.14 cputime=29.603 memavail=1728476 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.6 pwm=0.000
Stats 894.4: gcodein=0  mcu: mcu_awake=0.135 mcu_task_avg=0.000257 mcu_task_stddev=0.000266 bytes_write=88541 bytes_read=47134 bytes_retransmit=9 bytes_invalid=0 send_seq=3473 receive_seq=3473 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998315  orange_pi: temp=43.8 chamber_heater: target=0 temp=26.0 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.14 cputime=29.678 memavail=1729056 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 895.4: gcodein=0  mcu: mcu_awake=0.135 mcu_task_avg=0.000257 mcu_task_stddev=0.000266 bytes_write=90376 bytes_read=47961 bytes_retransmit=9 bytes_invalid=0 send_seq=3539 receive_seq=3539 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998308  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.9 pwm=0.000 heater_bed: target=0 temp=25.6 pwm=0.000 sysload=1.14 cputime=29.755 memavail=1729316 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 896.4: gcodein=0  mcu: mcu_awake=0.135 mcu_task_avg=0.000257 mcu_task_stddev=0.000266 bytes_write=92409 bytes_read=49144 bytes_retransmit=9 bytes_invalid=0 send_seq=3633 receive_seq=3633 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998302  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.6 pwm=0.000 sysload=1.13 cputime=29.845 memavail=1729592 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 897.4: gcodein=0  mcu: mcu_awake=0.135 mcu_task_avg=0.000257 mcu_task_stddev=0.000266 bytes_write=94283 bytes_read=50002 bytes_retransmit=9 bytes_invalid=0 send_seq=3702 receive_seq=3702 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998297  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.13 cputime=29.923 memavail=1729612 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 898.4: gcodein=0  mcu: mcu_awake=0.124 mcu_task_avg=0.000240 mcu_task_stddev=0.000262 bytes_write=95592 bytes_read=50704 bytes_retransmit=9 bytes_invalid=0 send_seq=3754 receive_seq=3754 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998295  orange_pi: temp=43.0 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.13 cputime=29.991 memavail=1729364 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 899.4: gcodein=0  mcu: mcu_awake=0.124 mcu_task_avg=0.000240 mcu_task_stddev=0.000262 bytes_write=97477 bytes_read=51635 bytes_retransmit=9 bytes_invalid=0 send_seq=3828 receive_seq=3828 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998291  orange_pi: temp=42.9 chamber_heater: target=0 temp=25.2 pwm=0.000 heater_bed: target=0 temp=25.9 pwm=0.000 sysload=1.13 cputime=30.067 memavail=1729112 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 900.4: gcodein=0  mcu: mcu_awake=0.124 mcu_task_avg=0.000240 mcu_task_stddev=0.000262 bytes_write=99491 bytes_read=52753 bytes_retransmit=9 bytes_invalid=0 send_seq=3917 receive_seq=3917 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998287  orange_pi: temp=43.0 chamber_heater: target=0 temp=25.5 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.13 cputime=30.154 memavail=1729112 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 901.4: gcodein=0  mcu: mcu_awake=0.124 mcu_task_avg=0.000240 mcu_task_stddev=0.000262 bytes_write=101461 bytes_read=53819 bytes_retransmit=9 bytes_invalid=0 send_seq=4002 receive_seq=4002 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998284  orange_pi: temp=42.7 chamber_heater: target=0 temp=25.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.12 cputime=30.238 memavail=1728860 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 902.4: gcodein=0  mcu: mcu_awake=0.124 mcu_task_avg=0.000240 mcu_task_stddev=0.000262 bytes_write=103358 bytes_read=54794 bytes_retransmit=9 bytes_invalid=0 send_seq=4080 receive_seq=4080 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998282  orange_pi: temp=42.9 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.12 cputime=30.322 memavail=1728620 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 903.4: gcodein=0  mcu: mcu_awake=0.142 mcu_task_avg=0.000263 mcu_task_stddev=0.000269 bytes_write=104646 bytes_read=55413 bytes_retransmit=9 bytes_invalid=0 send_seq=4125 receive_seq=4125 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998282  orange_pi: temp=43.1 chamber_heater: target=0 temp=26.1 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.12 cputime=30.387 memavail=1728396 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Stats 904.4: gcodein=0  mcu: mcu_awake=0.142 mcu_task_avg=0.000263 mcu_task_stddev=0.000269 bytes_write=106496 bytes_read=56240 bytes_retransmit=9 bytes_invalid=0 send_seq=4192 receive_seq=4191 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998280  orange_pi: temp=43.0 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.7 pwm=0.000 sysload=1.12 cputime=30.463 memavail=1728192 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 905.4: gcodein=0  mcu: mcu_awake=0.142 mcu_task_avg=0.000263 mcu_task_stddev=0.000269 bytes_write=108594 bytes_read=57527 bytes_retransmit=9 bytes_invalid=0 send_seq=4293 receive_seq=4293 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=2 upcoming_bytes=0 freq=71998279  orange_pi: temp=43.4 chamber_heater: target=0 temp=25.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.12 cputime=30.556 memavail=1727940 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.8 pwm=0.000
Neopixel update did not succeed
Stats 906.4: gcodein=0  mcu: mcu_awake=0.142 mcu_task_avg=0.000263 mcu_task_stddev=0.000269 bytes_write=110645 bytes_read=58822 bytes_retransmit=9 bytes_invalid=0 send_seq=4395 receive_seq=4395 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=42 upcoming_bytes=0 freq=71998278  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.8 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.11 cputime=30.650 memavail=1727940 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Stats 907.4: gcodein=0  mcu: mcu_awake=0.142 mcu_task_avg=0.000263 mcu_task_stddev=0.000269 bytes_write=112501 bytes_read=59688 bytes_retransmit=9 bytes_invalid=0 send_seq=4464 receive_seq=4464 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998276  orange_pi: temp=43.1 chamber_heater: target=0 temp=25.7 pwm=0.000 heater_bed: target=0 temp=25.8 pwm=0.000 sysload=1.11 cputime=30.728 memavail=1727960 print_time=374.877 buffer_time=0.000 print_stall=0 extruder: target=0 temp=25.7 pwm=0.000
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Neopixel update did not succeed
Unknown command:"RESTART :"
